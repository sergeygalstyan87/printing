(function(){var e={5336:function(e,t,l){"use strict";var a=l(9798),o=l(4220),r=l(7700);const s={class:"row"},c={class:"col-md-3 col-sm-12 sm-full-width"},n={class:"col-md-6 col-sm-12 canvas-column"},i={class:"canvas-designer"},d={class:"flex flex-center sm-overflow-scroll",id:"canvas-custom"},u={class:"col-md-3 col-sm-12 order-sm-last sm-full-width"};function p(e,t,l,a,p,m){const b=(0,o.g2)("LayersPanel"),g=(0,o.g2)("ModeSelector"),y=(0,o.g2)("ControlsPanel"),h=(0,o.g2)("q-page"),f=(0,o.g2)("q-page-container"),v=(0,o.g2)("q-layout"),k=(0,o.g2)("InitModal");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(v,{view:"lHh Lpr lFf"},{default:(0,o.k6)((()=>[(0,o.bF)(f,null,{default:(0,o.k6)((()=>[(0,o.bF)(h,{padding:""},{default:(0,o.k6)((()=>[(0,o.Lk)("div",s,[(0,o.Lk)("div",c,[(0,o.bF)(b)]),(0,o.Lk)("div",n,[(0,o.Lk)("div",i,[(0,o.bF)(g),(0,o.Lk)("div",d,[(0,o.Lk)("div",{class:"canvas-wrapper",style:(0,r.Tr)({backgroundImage:e.selectedModelColorUrl?`url('${e.selectedModelColorUrl}')`:null})},[(0,o.Lk)("div",{class:"canvas-block",style:(0,r.Tr)({height:e.selectedModelCoordinated?.height+"px",width:e.selectedModelCoordinated?.width+"px",top:e.selectedModelCoordinated?.top+"px",left:e.selectedModelCoordinated?.left+"px"})},[(0,o.Lk)("canvas",{style:(0,r.Tr)(e.selectedLayer.layerId?{border:"1px solid #e0e0e066",borderRadius:"5px"}:{}),ref:"canvas"},null,4)],4)],4)])])]),(0,o.Lk)("div",u,[(0,o.bF)(y)])])])),_:1})])),_:1})])),_:1}),(0,o.bF)(k)],64)}l(6734),l(7797),l(968);var m=l(3937),b=l(7599),g=l(7449);const y={"label.login":"Login","label.logout":"Logout","label.createAccount":"Create account","label.register":"Register","label.name":"Name","label.email":"Email","label.password":"Password","label.yes":"Yes","label.no":"No","label.layers":"Layers","label.files":"Files","label.projects":"Projects","label.image":"Image","label.text":"Text","label.loading":"Loading...","label.save":"Save","label.saveAs":"Save as","label.cancel":"Cancel","label.title":"Title","label.required":"Required","label.frontSide":"Front","label.backSide":"Back","label.select":"Select","label.create":"Create","label.delete":"Delete","label.selectModel":"Select model","label.product":"Product","label.object":"Object","label.catalog":"Catalog","label.createOwn":"Create your own","label.color":"Color","label.price":"Price","label.size":"Size","label.quantity":"Quantity","label.total":"Total","label.order":"Add to Card","label.phone":"Phone number","label.send":"Send","label.centerVertically":"Center vertically","label.centerHorizontally":"Center horizontally","label.flipHorizontally":"Flip horizontally","label.flipVertically":"Flip vertically","label.layerUp":"Layer up","label.layerDown":"Layer down","label.rotate":"Rotate","label.fontStyle":"Font style","label.fontFamily":"Font family","label.byAgreement":"By agreement","text.loadingAppState":"Loading app state","text.selectObjectForCustomization":"Select an object to edit its parameters","text.loginForProjects":"To save/load a project you need to","text.notSavedProjects":"You don't have any saved projects yet","text.confirmDelete":"Do you confirm deletion?","text.projectName":"Project name","text.applicationAccepted":"Application accepted","text.thanksApplicationAccepted":"Thank you, your application has been accepted!","text.weWillContactYou":"We will contact you shortly.","text.orderBeingProcessed":"Please wait while your order is being processed.","text.canTakeSometime":"It can take some time.","text.successfullyCreated":"Successfully created","text.successfullyDeleted":"Successfully deleted","text.successfullyUpdated":"Successfully updated","text.successfullyloggedIn":"You are successfully logged in","text.dblClickForCrop":"Double click on image to start cropping","text.error.emptyName":"The name cannot be empty","text.error.emptyTitle":"The title cannot be empty","text.error.emptyPhone":"Fill in your phone number","text.error.invalidEmail":"Invalid email","text.error.shortPassword":"The password must contain at least 8 characters","text.error.cantUploadFile":"Failed to upload file to server","text.error.errorOccurred":"An error has occurred. Please try again later.","text.error.invalidEmailOrPassword":"Invalid email or password","text.error.emailAlreadyUsed":"A user with this email already exists",xxx:"yyy"};var h=y;const f={"label.login":"Войти","label.logout":"Выйти","label.createAccount":"Создать аккаунт","label.register":"Зарегистрироваться","label.name":"Имя","label.email":"Email","label.password":"Пароль","label.yes":"Да","label.no":"Нет","label.layers":"Слои","label.files":"Файлы","label.projects":"Проекты","label.image":"изображение","label.text":"Текст","label.loading":"Загрузка...","label.save":"Сохранить","label.saveAs":"Сохр. как","label.cancel":"Отментиь","label.title":"Название","label.required":"Обязательно","label.frontSide":"Передняя","label.backSide":"Задняя","label.select":"Выбрать","label.create":"Создать","label.delete":"Удалить","label.selectModel":"Выберите модель","label.product":"Продукт","label.object":"Объект","label.catalog":"Каталог","label.createOwn":"Создать свой","label.color":"Цвет","label.price":"Цена","label.size":"Размер","label.quantity":"Kоличество","label.total":"Общее","label.order":"Заказать","label.phone":"Номер телефона","label.send":"Отправить","label.centerVertically":"Центрировать по вертикали","label.centerHorizontally":"Центрировать по горизонтали","label.flipHorizontally":"Отразить по горизонтали","label.flipVertically":"Отразить по вертикали","label.layerUp":"Слой вверх","label.layerDown":"Слой вниз","label.rotate":"Поворот","label.fontStyle":"Стиль фонта","label.fontFamily":"Фонт","label.byAgreement":"По соглашению","text.loadingAppState":"Загрузка состояния приложения","text.selectObjectForCustomization":"Выберите объект для редактирования его параметров","text.loginForProjects":"Чтобы сохранить/загрузить проект нужно","text.notSavedProjects":"У вас еще нет сохраненных проектов","text.confirmDelete":"Подтверждаете удаление ?","text.projectName":"Название проекта","text.applicationAccepted":"Заявка принята","text.thanksApplicationAccepted":"Спасибо, ваша заявка принята!","text.weWillContactYou":"Мы свяжемся с вами в ближайшее время.","text.orderBeingProcessed":"Пожалуйста подождите, ваш заказ обрабатывается.","text.canTakeSometime":"Это может занять некоторое время.","text.successfullyCreated":"Успещно создан","text.successfullyDeleted":"Успещно удалена","text.successfullyUpdated":"Успещно обновлен","text.successfullyloggedIn":"Вы успешно авторизованы","text.dblClickForCrop":"Дважды щелкните по изображению, чтобы начать обрезку","text.error.emptyName":"Имя не может быть пустым","text.error.emptyTitle":"Название не может быть пустым","text.error.emptyPhone":"Заполните номер телефона","text.error.invalidEmail":"Неверный e-mail","text.error.shortPassword":"Пароль должен содержать не менее 8 символов","text.error.cantUploadFile":"Не удалось загрузить файл на сервер","text.error.errorOccurred":"Произошла ошибка. Повторите попытку позже","text.error.invalidEmailOrPassword":"Неверный email или пароль","text.error.emailAlreadyUsed":"Пользователь с таким email уже существует",xxx:"yyy"};var v=f;const k={en:h,ru:v},x=()=>{const e=localStorage.getItem("app_lang");return k[e]?e:"en"},C=e=>{localStorage.setItem("app_lang",e)},L=(0,g.hU)({locale:x(),messages:k}),{t:A}=L.global;var S=l(4413);const F=S.A.create({baseURL:"https://app.print-rtp.ru/api/"});F.interceptors.request.use((e=>{const t="a1b2c3d4e5f6789abc0d1234567890abc";return t&&(e.headers["Authorization"]=`Bearer ${t}`),e}),(e=>Promise.reject(e)));var _=F,w=l(5110);const I={async getProfile(){try{let e=await _.get("users/me");return e.data.user}catch(e){return localStorage.removeItem("accessToken"),!1}},async login(e,t){try{let l=await _.post("users/login",{email:e,password:t});return localStorage.setItem("accessToken",l.data.token),w.A.create({type:"success",message:A("text.successfullyloggedIn")}),l.data.user}catch(l){return w.A.create({type:"error",message:A("text.invalidEmailOrPassword")}),!1}},async register(e,t,l){try{return await _.post("users",{name:e,email:t,password:l}),this.login(t,l)}catch(a){return w.A.create({type:"error",message:A("text.error.emailAlreadyUsed")}),!1}},async logout(){try{await _.post("users/logout")}catch(e){}localStorage.removeItem("accessToken"),localStorage.removeItem("appUser")}};var M=I,q=l(7119);l(4645),l(9063),l(3665),l(988);const j={get:(e,t=null)=>{try{let l=JSON.parse(localStorage.getItem(e));"object"===typeof l&&null!==l&&(t=l)}catch(l){t=null}return t},set:(e,t)=>{localStorage.setItem(e,JSON.stringify(t))}},P=b.fabric.Canvas.prototype._onTouchStart;b.fabric.util.object.extend(b.fabric.Canvas.prototype,{_onTouchStart:function(e){var t=this.findTarget(e);(!this.allowTouchScrolling||t||this.isDrawingMode)&&P.call(this,e)}});const O=e=>{const t=Object.create(Object.getPrototypeOf(e)),l=Object.getOwnPropertyDescriptors(e);for(let a in l)l[a].hasOwnProperty("value")?t[a]=l[a].value:t[a]=l[a];return t};var T={namespaced:!0,state(){return{user:j.get("appUser"),projects:[],selectedProjectId:null,projectsFetched:!1,controlTab:"product",authModalOpened:!1,uploadedImages:j.get("print-uploaded-images",[])}},mutations:{setUser(e,t){e.user={id:t.id,name:t.name},j.set("appUser",e.user)},setProjects(e,t){e.projects=t},pushProject(e,t){e.projects.unshift(t)},deleteProject(e,t){e.projects=e.projects.filter((e=>e.id!=t))},setSelectedProjectId(e,t){e.selectedProjectId=t},setProjectsFetched(e,t){e.projectsFetched=t},setControlTab(e,t){e.controlTab=t},pushUploadedImage(e,t){e.uploadedImages.push(t),j.set("print-uploaded-images",e.uploadedImages)},removeUploadedImage(e,t){e.uploadedImages=e.uploadedImages.filter((e=>e.id!=t)),j.set("print-uploaded-images",e.uploadedImages)}}},Q=(l(757),{namespaced:!0,state(){return{pricing:{},price:0,sizes:{xs:0,s:0,m:0,l:0,xl:0,xxl:0}}},mutations:{setPrice(e,t){e.price=t},setPricing(e,t){e.pricing=t}},getters:{quantity(e,t,l){return l.product.selectedModel.clientModel?1:Object.values(e.sizes).reduce(((e,t)=>parseInt(e)+parseInt(t)),0)}},actions:{calculatePrice({state:e,getters:t,commit:l,rootState:a}){let o=0,r=t.quantity,s=a.canvas.layers.length,c=a.product.selectedModel;if(!c.clientModel){if(r>W(c.prices))return void l("setPrice",A("label.byAgreement"));o=X(c.prices,r)}if(s>W(e.pricing.prices))return void l("setPrice",A("label.byAgreement"));let n=X(e.pricing.prices,s)*s,i=(o+n)*r;i=Math.round(i),l("setPrice",i)}}});const X=(e=[],t)=>{let l=e.filter((e=>e.from<=t&&e.to>=t));return l.length>0?l[0].value:0},W=(e=[])=>e.length>0?e[e.length-1].to:0;var V={namespaced:!0,state(){return{mode:"front",layers:[],selectedLayer:E()}},mutations:{setMode(e,t){e.mode=t},syncLayers(e,t){e.layers=t,this.dispatch("order/calculatePrice")},setSelectedLayer(e,t){e.controlTab="object",e.selectedLayer=t},resetSelectedLayer(e){e.controlTab="product",e.selectedLayer=E()}}};const E=()=>({layerId:null,layerType:null,text:null,fill:null,fontSize:null,fontWeight:"normal",fontStyle:"normal",underline:!1,fontFamily:null,angle:0,flipX:!1,flipY:!1,scaleAndZoom:0});var U={namespaced:!0,state(){return{models:[],selectedModel:null,selectedModelColor:null}},mutations:{setModels(e,t){e.models=t,e.selectedModel||(e.selectedModel=t[0],e.selectedModelColor=e.selectedModel.images[0])},pushModel(e,t){e.models.push(t)},deleteModel(e,{id:t}){e.models=e.models.filter((e=>e.id!=t)),e.selectedModel.id==t&&this.commit("product/setModels",e.models)},setSelectedModel(e,t){e.selectedModel=t,e.selectedModelColor=e.selectedModel.images[0],this.dispatch("order/calculatePrice")},setSelectedModelColor(e,t){e.selectedModelColor=t},selectFristModel(e){this.commit("product/setSelectedModel",e.models[0])}},getters:{selectedModelColorUrl(e,t,l){return e.selectedModelColor?e.selectedModelColor[l.canvas.mode].url:null},selectedModelCoordinated(e,t,l){const a=96;return e.selectedModelColor?{top:e.selectedModelColor[l.canvas.mode].top*a,left:e.selectedModelColor[l.canvas.mode].left*a,height:e.selectedModelColor[l.canvas.mode].height*a,width:e.selectedModelColor[l.canvas.mode].width*a}:null}}};const Y=(0,m.y$)({modules:{app:T,order:Q,canvas:V,product:U}}),$={async upload(e){try{let t=await _.post("https://demo.yansprint.com/api/file-preview",e);return t.data}catch(t){return w.A.create({type:"error",message:A("text.error.cantUploadFile")}),!1}},async uploadBlob(e){try{let t=new FormData;t.append("file",e,"capture.png");let l=await _.post("media",t,{headers:{"Content-Type":"multipart/form-data"}});return l.data.doc}catch(t){return w.A.create({type:"error",message:A("text.error.cantUploadFile")}),!1}}};var z=$;const B={canvas:null};class H{static drawSelectedModel(){const e=B.canvas.getCenter();B.canvas.setBackgroundImage(Y.getters["product/selectedModelColorUrl"],(e=>(B.canvas.backgroundImage.scaleX=B.canvas.getWidth()/e.width*H.scale,B.canvas.backgroundImage.scaleY=B.canvas.getHeight()/e.height*H.scale,B.canvas.renderAll())),{backgroundImageOpacity:1,backgroundImageStretch:!1,top:e.top,left:e.left,originX:"center",originY:"center",crossOrigin:"anonymous"}),B.canvas.renderAll()}static addTextLayer(e="Print Designer"){let t=B.canvas.getCenter(),l=new b.fabric.Text(e,{layerId:Date.now(),layerType:"text",mode:Y.state.canvas.mode,fill:"#000000",fontSize:H.fontSize,fontFamily:"Lato",scaleX:1,scaleY:1,top:t.top,left:t.left,originX:"center",originY:"center",borderColor:"#3474d4",cornerColor:"#3474d4",strokeWidth:20,cornerSize:15,transparentCorners:!1,_controlsVisibility:{mt:!1,mb:!1,ml:!1,mr:!1}});B.canvas.add(l),B.canvas.setActiveObject(l),B.canvas.renderAll()}static addImageLayer(e){b.fabric.Image.fromURL(e,(e=>{e.set({layerId:Date.now(),layerType:"image",mode:Y.state.canvas.mode,borderColor:"#3474d4",cornerColor:"#3474d4",strokeWidth:20,cornerSize:15,transparentCorners:!1,_controlsVisibility:{mt:!1,mb:!1,ml:!1,mr:!1}});var t=.35*B.canvas.getWidth();e.scaleToWidth(t),B.canvas.add(e),B.canvas.centerObject(e),e.setCoords(),B.canvas.setActiveObject(e),B.canvas.renderAll()}),{crossOrigin:"anonymous"})}static changeMode(){B.canvas.getObjects().forEach((e=>{e.visible=e.mode==Y.state.canvas.mode})),B.canvas.discardActiveObject(),B.canvas.renderAll()}static selectLayer(e,t=()=>{}){B.canvas.getObjects().forEach((l=>{l.layerId==e.layerId&&(B.canvas.setActiveObject(l),B.canvas.renderAll(),t(l))}))}static removeLayer(e){B.canvas.getObjects().forEach((t=>{t.layerId==e.layerId&&(B.canvas.remove(t),B.canvas.renderAll())}))}static duplicateLayer(e){B.canvas.getObjects().forEach((t=>{if(t.layerId==e.layerId){const e=O(t);e.set({layerId:Date.now(),left:e.left+10,top:e.top+10}),B.canvas.add(e),B.canvas.renderAll()}}))}static filter(e){return{get(){return!!this.selectedLayer.filters.filter((t=>t.type==e)).length},set(t){t?this.selectedLayer.filters.push(new b.fabric.Image.filters[e]):this.selectedLayer.filters=this.selectedLayer.filters.filter((t=>t.type!=e)),this.selectedLayer.applyFilters()}}}static toJSON(){return B.canvas.toJSON(["mode","layerId","layerType","_controlsVisibility"])}static loadFromJSON(e,t=()=>{}){B.canvas.loadFromJSON(e,t)}static deleteAllLayers(){B.canvas.getObjects().forEach((e=>{B.canvas.remove(e)}))}static async takeVirtualCapture(e){let t=new b.fabric.Canvas(null,{width:B.canvas.width,height:B.canvas.height});return new Promise((l=>{t.loadFromJSON(this.toJSON(),(()=>{t.getObjects().forEach((t=>{t.visible=t.mode==e}));const a=t.getCenter();t.setBackgroundImage(Y.state.product.selectedModelColor[e].url,(e=>{t.backgroundImage.scaleX=t.getWidth()/e.width*H.scale,t.backgroundImage.scaleY=t.getHeight()/e.height*H.scale,t.renderAll().getElement().toBlob((e=>{l(e)}),"image/png",1)}),{backgroundImageOpacity:1,backgroundImageStretch:!1,scaleX:.35,scaleY:.35,top:a.top,left:a.left,originX:"center",originY:"center",crossOrigin:"anonymous"})}))}))}static async capture(){let e,t,l=await this.takeVirtualCapture("front");if(e=await z.uploadBlob(l),console.log(Y.state.product.selectedModelColor.back),Y.state.product.selectedModelColor.back){let e=await this.takeVirtualCapture("back");t=await z.uploadBlob(e)}return{front:e,back:t}}static prepareCrop(e){var t=new b.fabric.Rect({id:"crop-rect",top:e.top,left:e.left,angle:e.angle,width:e.getScaledWidth(),height:e.getScaledHeight(),stroke:"rgb(42, 67, 101)",strokeWidth:2,strokeDashArray:[5,5],fill:"rgba(255, 255, 255, 1)",globalCompositeOperation:"overlay",lockRotation:!0}),l=new b.fabric.Rect({id:"overlay-rect",top:e.top,left:e.left,angle:e.angle,width:e.getScaledWidth(),height:e.getScaledHeight(),selectable:!1,selection:!1,fill:"rgba(0, 0, 0, 0.5)",lockRotation:!0}),a=e.cropX,o=e.cropY,r=e.width,s=e.height;e.set({cropX:null,cropY:null,left:e.left-a*e.scaleX,top:e.top-o*e.scaleY,width:e._originalElement.naturalWidth,height:e._originalElement.naturalHeight,dirty:!1}),t.set({left:e.left+a*e.scaleX,top:e.top+o*e.scaleY,width:r*e.scaleX,height:s*e.scaleY,dirty:!1}),l.set({left:e.left,top:e.top,width:e.width*e.scaleX,height:e.height*e.scaleY,dirty:!1}),t.oldScaleX=t.scaleX,t.oldScaleY=t.scaleY,B.canvas.add(l),B.canvas.add(t),B.canvas.discardActiveObject(),B.canvas.setActiveObject(t),B.canvas.renderAll(),t.on("moving",(function(){(t.top<e.top||t.left<e.left)&&(t.left=t.left<e.left?e.left:t.left,t.top=t.top<e.top?e.top:t.top),(t.top+t.getScaledHeight()>e.top+e.getScaledHeight()||t.left+t.getScaledWidth()>e.left+e.getScaledWidth())&&(t.top=t.top+t.getScaledHeight()>e.top+e.getScaledHeight()?e.top+e.getScaledHeight()-t.getScaledHeight():t.top,t.left=t.left+t.getScaledWidth()>e.left+e.getScaledWidth()?e.left+e.getScaledWidth()-t.getScaledWidth():t.left)})),t.on("deselected",(function(){H.cropImage(t,e),B.canvas.remove(l)}))}static cropImage(e,t){B.canvas.remove(e);const l=(e.left-t.left)/t.scaleX,a=(e.top-t.top)/t.scaleY,o=e.width*e.scaleX/t.scaleX,r=e.height*e.scaleY/t.scaleY;t.set({cropX:l,cropY:a,width:o,height:r,top:t.top+a*t.scaleY,left:t.left+l*t.scaleX,selectable:!0,cropped:1}),B.canvas.renderAll()}}(0,q.A)(H,"fontSize",16),(0,q.A)(H,"scale",1);var D=H;l(6029);const N={async getModel(e,t){try{let l=await _.get(`https://demo.yansprint.com/api/product/${e}?project_id=${t}`);return l.data.images.map((e=>{e[2]&&(e.front=e[2],delete e[2]),e[3]&&(e.back=e[3],delete e[3]),e[4]&&(e.left_side=e[4],delete e[4]),e[5]&&(e.right_side=e[5],delete e[5])})),[l.data]}catch(l){return!1}},async getModels(e=null){try{let t=await _.post("products/models",{userId:e});return t.data.docs}catch(t){return!1}},async create(e){try{let t=await _.post("products",e);return w.A.create({type:"success",message:A("text.successfullyCreated")}),t.data.doc}catch(t){return w.A.create({type:"error",message:A("text.error.errorOccurred")}),!1}},async delete(e){try{let t=await _.delete(`products/${e}`);return w.A.create({type:"success",message:A("text.successfullyDeleted")}),console.log("delete: ",t),!0}catch(t){return console.log("error:create: ",t),w.A.create({type:"error",message:A("text.error.errorOccurred")}),!1}}};var R=N,K=l(3158),J=l.n(K);const G={google:{families:["Splash","Dancing Script","Oswald","Raleway","Lobster","Pacifico","Rubik Gemstones","Rubik Spray Paint","Rubik Vinyl","Caveat","Press Start 2P","Marck Script","Neucha","Kosugi Maru","Bad Script","Vollkorn SC"]},timeout:2e3},Z=[...G.google.families];var ee=G;const te={class:"text-grey-8 q-gutter-xs"};function le(e,t,l,s,c,n){const i=(0,o.g2)("q-tab"),d=(0,o.g2)("q-tabs"),u=(0,o.g2)("LayersList"),p=(0,o.g2)("q-tab-panel"),m=(0,o.g2)("q-img"),b=(0,o.g2)("q-item-section"),g=(0,o.g2)("q-item-label"),y=(0,o.g2)("q-btn"),h=(0,o.g2)("q-item"),f=(0,o.g2)("q-separator"),v=(0,o.g2)("q-list"),k=(0,o.g2)("q-tab-panels"),x=(0,o.gN)("ripple");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(d,{modelValue:e.tab,"onUpdate:modelValue":t[0]||(t[0]=t=>e.tab=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{name:"layers",label:e.$t("label.layers")},null,8,["label"]),(0,o.bF)(i,{name:"images",label:e.$t("label.files")},null,8,["label"])])),_:1},8,["modelValue"]),(0,o.bF)(k,{modelValue:e.tab,"onUpdate:modelValue":t[1]||(t[1]=t=>e.tab=t),animated:""},{default:(0,o.k6)((()=>[(0,o.bF)(p,{name:"layers",class:"q-px-none"},{default:(0,o.k6)((()=>[(0,o.bF)(u)])),_:1}),(0,o.bF)(p,{name:"images",class:"q-px-none"},{default:(0,o.k6)((()=>[(0,o.bF)(v,{bordered:"",separator:"",class:"scroll-area"},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.uploadedImages,(t=>(0,o.bo)(((0,o.uX)(),(0,o.Wv)(h,{key:t.id,onClick:e=>n.addToLayers(t.url),clickable:""},{default:(0,o.k6)((()=>[(0,o.bF)(b,{avatar:""},{default:(0,o.k6)((()=>[(0,o.bF)(m,{src:t.url,style:{height:"34px","max-width":"34px"}},null,8,["src"])])),_:2},1024),(0,o.bF)(b,{top:""},{default:(0,o.k6)((()=>[(0,o.bF)(g,{class:"q-mt-sm"},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.$t("label.image")),1)])),_:1})])),_:1}),(0,o.bF)(b,{avatar:"",side:""},{default:(0,o.k6)((()=>[(0,o.Lk)("div",te,[(0,o.bF)(y,{class:"text-red",size:"12px",flat:"",dense:"",round:"",icon:"delete",onClick:(0,a.D$)((l=>e.removeUploadedImage(t.id)),["stop"])},null,8,["onClick"]),(0,o.bF)(y,{size:"12px",flat:"",dense:"",round:"",icon:"add"})])])),_:2},1024)])),_:2},1032,["onClick"])),[[x]]))),128)),(0,o.bo)((0,o.bF)(f,null,null,512),[[a.aG,e.uploadedImages.length]])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}const ae={class:"q-pb-md q-px-2"};function oe(e,t,l,r,s,c){const n=(0,o.g2)("q-btn"),i=(0,o.g2)("LayerItem"),d=(0,o.g2)("LoadingItem"),u=(0,o.g2)("q-separator"),p=(0,o.g2)("q-list");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",ae,[(0,o.bF)(n,{"no-caps":"",onClick:c.addTextLayer,color:"white","text-color":"black",icon:"add",label:e.$t("label.text"),class:"q-mr-sm"},null,8,["onClick","label"]),(0,o.bF)(n,{"no-caps":"",onClick:t[0]||(t[0]=e=>this.$refs.fileInput.click()),color:"primary",icon:"file_upload",label:e.$t("label.image")},null,8,["label"]),(0,o.Lk)("input",{ref:"fileInput",type:"file",onChange:t[1]||(t[1]=(...e)=>c.uploadImage&&c.uploadImage(...e)),class:"hidden"},null,544)]),(0,o.bF)(p,{bordered:"",separator:"",class:"scroll-area"},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.layers,(t=>((0,o.uX)(),(0,o.CE)(o.FK,{key:t.layerId},[t.mode==e.mode?((0,o.uX)(),(0,o.Wv)(i,{key:0,layer:t},null,8,["layer"])):(0,o.Q3)("",!0)],64)))),128)),e.loadingLayer?((0,o.uX)(),(0,o.Wv)(d,{key:0})):(0,o.Q3)("",!0),(0,o.bo)((0,o.bF)(u,null,null,512),[[a.aG,e.layers.length]])])),_:1})],64)}const re={class:"text-black-8 q-gutter-xs"};function se(e,t,l,s,c,n){const i=(0,o.g2)("q-img"),d=(0,o.g2)("q-icon"),u=(0,o.g2)("q-item-section"),p=(0,o.g2)("q-item-label"),m=(0,o.g2)("q-btn"),b=(0,o.g2)("q-item"),g=(0,o.gN)("ripple");return(0,o.bo)(((0,o.uX)(),(0,o.Wv)(b,{onClick:t[2]||(t[2]=e=>n.selectLayer(l.layer)),active:l.layer.layerId==e.selectedLayer.layerId,"active-class":"bg-accent text-black-8 active-layer",clickable:""},{default:(0,o.k6)((()=>[(0,o.bF)(u,{avatar:"",top:""},{default:(0,o.k6)((()=>["image"==l.layer.layerType?((0,o.uX)(),(0,o.Wv)(i,{key:0,src:l.layer._originalElement?.currentSrc,style:{height:"34px","max-width":"34px"}},null,8,["src"])):((0,o.uX)(),(0,o.Wv)(d,{key:1,name:"title",color:"black",size:"34px"}))])),_:1}),(0,o.bF)(u,{top:""},{default:(0,o.k6)((()=>["image"==l.layer.layerType?((0,o.uX)(),(0,o.Wv)(p,{key:0,class:"q-mt-sm"},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.$t("label.image")),1)])),_:1})):((0,o.uX)(),(0,o.Wv)(p,{key:1,class:"q-mt-sm layer-title"},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(l.layer.text),1)])),_:1}))])),_:1}),(0,o.bF)(u,{avatar:"",side:""},{default:(0,o.k6)((()=>[(0,o.Lk)("div",re,[(0,o.bF)(m,{class:"text-secondary",size:"12px",flat:"",dense:"",icon:"content_copy",onClick:t[0]||(t[0]=(0,a.D$)((e=>n.duplicateLayer(l.layer)),["stop"]))}),(0,o.bF)(m,{class:"text-red",size:"12px",flat:"",dense:"",round:"",icon:"delete",onClick:t[1]||(t[1]=(0,a.D$)((e=>n.removeLayer(l.layer)),["stop"]))})])])),_:1})])),_:1},8,["active"])),[[g]])}var ce={name:"LayerItem",inject:["ctx"],props:["layer"],data:()=>({}),computed:{...(0,m.aH)("canvas",["selectedLayer"])},methods:{...(0,m.PY)("canvas",["setSelectedLayer"]),selectLayer(e){D.selectLayer(e,(e=>{this.setSelectedLayer(e)}))},removeLayer(e){D.removeLayer(e)},duplicateLayer(e){D.duplicateLayer(e)}}},ne=l(1317),ie=l(5740),de=l(1484),ue=l(5678),pe=l(4503),me=l(2473),be=l(3197),ge=l(5408),ye=l(2110),he=l.n(ye);const fe=(0,ne.A)(ce,[["render",se]]);var ve=fe;function ke(e,t,l,a,s,c){const n=(0,o.g2)("q-spinner"),i=(0,o.g2)("q-item-section"),d=(0,o.g2)("q-item-label"),u=(0,o.g2)("q-item"),p=(0,o.gN)("ripple");return(0,o.bo)(((0,o.uX)(),(0,o.Wv)(u,null,{default:(0,o.k6)((()=>[(0,o.bF)(i,{avatar:"",top:""},{default:(0,o.k6)((()=>[(0,o.bF)(n,{color:"primary",size:"2em"})])),_:1}),(0,o.bF)(i,{top:"",class:"gt-sm"},{default:(0,o.k6)((()=>[(0,o.bF)(d,{class:"q-mt-sm"},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.$t("label.loading")),1)])),_:1})])),_:1})])),_:1})),[[p]])}he()(ce,"components",{QItem:ie.A,QItemSection:de.A,QImg:ue.A,QIcon:pe.A,QItemLabel:me.A,QBtn:be.A}),he()(ce,"directives",{Ripple:ge.A});var xe={name:"LoadingItem"},Ce=l(6119);const Le=(0,ne.A)(xe,[["render",ke]]);var Ae=Le;he()(xe,"components",{QItem:ie.A,QItemSection:de.A,QSpinner:Ce.A,QItemLabel:me.A}),he()(xe,"directives",{Ripple:ge.A});var Se={name:"LayersList",components:{LayerItem:ve,LoadingItem:Ae},data:()=>({tab:"layers",loadingLayer:!1}),computed:{...(0,m.aH)("canvas",["layers","mode"])},methods:{...(0,m.PY)("app",["pushUploadedImage"]),addTextLayer(){D.addTextLayer()},addImageLayer(e){D.addImageLayer(e)},async uploadImage(e){let t=e.target.files[0];if(!t)return;this.loadingLayer=!0;let l=new FormData;l.append("file_preview",t);let a=await z.upload(l);a&&(this.addImageLayer(a.url),this.pushUploadedImage({id:Date.now(),url:a.url})),this.loadingLayer=!1}}},Fe=l(5668),_e=l(5861);const we=(0,ne.A)(Se,[["render",oe]]);var Ie=we;he()(Se,"components",{QBtn:be.A,QList:Fe.A,QSeparator:_e.A});var Me={name:"LayersPanel",components:{LayersList:Ie},data:()=>({tab:"layers"}),computed:{...(0,m.aH)("app",["uploadedImages"])},methods:{...(0,m.PY)("app",["removeUploadedImage"]),addToLayers(e){D.addImageLayer(e),this.tab="layers"}}},qe=l(4591),je=l(5713),Pe=l(588),Oe=l(9689);const Te=(0,ne.A)(Me,[["render",le]]);var Qe=Te;he()(Me,"components",{QTabs:qe.A,QTab:je.A,QTabPanels:Pe.A,QTabPanel:Oe.A,QList:Fe.A,QItem:ie.A,QItemSection:de.A,QImg:ue.A,QItemLabel:me.A,QBtn:be.A,QSeparator:_e.A}),he()(Me,"directives",{Ripple:ge.A});const Xe={class:"q-pa-md row items-start mode-selector"},We={key:0,class:"selectors-wrapper"},Ve=["src"],Ee=["src"],Ue=["src"],Ye=["src"];function $e(e,t,l,a,s,c){return(0,o.uX)(),(0,o.CE)("div",Xe,[e.selectedModelColor?((0,o.uX)(),(0,o.CE)("div",We,[(0,o.Lk)("div",{onClick:t[0]||(t[0]=t=>e.setMode("front")),class:(0,r.C4)([{active:"front"==e.mode},"selector-item"])},[(0,o.Lk)("img",{src:e.selectedModelColor.front.url,alt:""},null,8,Ve)],2),e.selectedModelColor.back?((0,o.uX)(),(0,o.CE)("div",{key:0,onClick:t[1]||(t[1]=t=>e.setMode("back")),class:(0,r.C4)([{active:"back"==e.mode},"selector-item"])},[e.selectedModelColor.back?((0,o.uX)(),(0,o.CE)("img",{key:0,src:e.selectedModelColor.back.url,alt:""},null,8,Ee)):(0,o.Q3)("",!0)],2)):(0,o.Q3)("",!0),e.selectedModelColor.left_side?((0,o.uX)(),(0,o.CE)("div",{key:1,onClick:t[2]||(t[2]=t=>e.setMode("left_side")),class:(0,r.C4)([{active:"left_side"==e.mode},"selector-item"])},[e.selectedModelColor.left_side?((0,o.uX)(),(0,o.CE)("img",{key:0,src:e.selectedModelColor.left_side.url,alt:""},null,8,Ue)):(0,o.Q3)("",!0)],2)):(0,o.Q3)("",!0),e.selectedModelColor.right_side?((0,o.uX)(),(0,o.CE)("div",{key:2,onClick:t[3]||(t[3]=t=>e.setMode("right_side")),class:(0,r.C4)([{active:"right_side"==e.mode},"selector-item"])},[e.selectedModelColor.right_side?((0,o.uX)(),(0,o.CE)("img",{key:0,src:e.selectedModelColor.right_side.url,alt:""},null,8,Ye)):(0,o.Q3)("",!0)],2)):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)])}var ze={name:"ModeSelector",computed:{...(0,m.aH)("canvas",["mode"]),...(0,m.aH)("product",["selectedModel","selectedModelColor"])},watch:{mode(){this.changeMode()},selectedModel(){"undefined"===typeof this.selectedModelColor.back&&this.setMode("front")}},methods:{...(0,m.PY)("canvas",["setMode"]),changeMode(){D.changeMode()}}};const Be=(0,ne.A)(ze,[["render",$e]]);var He=Be;function De(e,t,l,a,r,s){const c=(0,o.g2)("q-tab"),n=(0,o.g2)("q-tabs"),i=(0,o.g2)("SelectedModel"),d=(0,o.g2)("q-tab-panel"),u=(0,o.g2)("ObjectDetails"),p=(0,o.g2)("q-tab-panels");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(n,{modelValue:s.tab,"onUpdate:modelValue":t[0]||(t[0]=e=>s.tab=e),"inline-label":"",dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify"},{default:(0,o.k6)((()=>[(0,o.bF)(c,{name:"product",icon:"crop_original",label:e.$t("label.product")},null,8,["label"]),(0,o.bF)(c,{name:"object",icon:"tune",label:e.$t("label.object")},null,8,["label"])])),_:1},8,["modelValue"]),(0,o.bF)(p,{modelValue:s.tab,"onUpdate:modelValue":t[1]||(t[1]=e=>s.tab=e),animated:""},{default:(0,o.k6)((()=>[(0,o.bF)(d,{name:"product",class:"q-px-none"},{default:(0,o.k6)((()=>[(0,o.bF)(i)])),_:1}),(0,o.bF)(d,{name:"object",class:"q-px-none scroll-area"},{default:(0,o.k6)((()=>[(0,o.bF)(u)])),_:1})])),_:1},8,["modelValue"])],64)}const Ne={class:"text-h6"},Re={class:"text-subtitle1"},Ke=["onClick"],Je={class:"row justify-center q-mt-md"};function Ge(e,t,l,a,s,c){const n=(0,o.g2)("q-card-section"),i=(0,o.g2)("q-icon"),d=(0,o.g2)("q-card-actions"),u=(0,o.g2)("q-btn"),p=(0,o.g2)("LoadingItem"),m=(0,o.g2)("q-card");return e.selectedModel?((0,o.uX)(),(0,o.Wv)(m,{key:0,class:"q-mx-2"},{default:(0,o.k6)((()=>[(0,o.bF)(n,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",Ne,(0,r.v_)(e.selectedModel.title),1)])),_:1}),(0,o.bF)(n,null,{default:(0,o.k6)((()=>[(0,o.Lk)("p",Re,(0,r.v_)(e.$t("label.color")),1),(0,o.bF)(d,{class:"colors"},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.selectedModel.images,(t=>((0,o.uX)(),(0,o.CE)("div",{key:t.front.url,onClick:l=>e.setSelectedModelColor(t),class:"cursor-pointer model-colors"},[e.selectedModelColor.id==t.id?((0,o.uX)(),(0,o.Wv)(i,{key:0,class:"check-icon",name:"check",size:"20px"})):(0,o.Q3)("",!0),(0,o.Lk)("div",{class:(0,r.C4)(["color",{active:e.selectedModelColor.id==t.id}]),style:(0,r.Tr)({background:t.hex})},null,6)],8,Ke)))),128))])),_:1}),(0,o.Lk)("div",Je,[e.loading?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(u,{key:0,"no-caps":"",color:"primary",icon:"shopping_basket",label:e.$t("label.order"),onClick:c.createOrder,disabled:!c.canOrder()},null,8,["label","onClick","disabled"])),e.loading?((0,o.uX)(),(0,o.Wv)(p,{key:1})):(0,o.Q3)("",!0)])])),_:1})])),_:1})):(0,o.Q3)("",!0)}const Ze={async create(e){try{let t=await _.post("https://demo.yansprint.com/api/order",e);return t.data.doc}catch(t){return w.A.create({type:"error",message:A("text.error.errorOccurred")}),!1}}};var et=Ze,tt=l(6566),lt=l.n(tt),at={name:"SelectedModel",components:{LoadingItem:Ae},data:()=>({orderModal:!1,orderCreatedModal:!1,loading:!1,phone:"",email:""}),watch:{sizes:{handler(){this.calculatePrice()},deep:!0}},computed:{...(0,m.aH)("app",["user","pricing"]),...(0,m.aH)("order",["price","sizes"]),...(0,m.aH)("product",["selectedModel","selectedModelColor"]),...(0,m.aH)("canvas",["layers"]),...(0,m.L8)("order",["quantity"])},methods:{...(0,m.PY)("product",["setSelectedModelColor"]),...(0,m.PY)("app",[]),...(0,m.PY)("canvas",["resetSelectedLayer"]),...(0,m.i0)("order",["calculatePrice"]),canOrder(){return this.layers.length>0},async createOrder(){this.loading=!0;const e=document.getElementById("canvas-custom");let t="";const l=new URL(window.location.href),a=l.searchParams.get("product_id"),o=l.searchParams.get("project_id");this.resetSelectedLayer(),lt()(e,{useCORS:!0}).then((e=>{t=e.toDataURL("image/png");let l=et.create({title:"Order №"+Date.now(),screenShot:t,productId:a,projectId:o,json:JSON.stringify({model:this.selectedModelColor,canvasData:D.toJSON()})});l&&(this.orderModal=!1,this.orderCreatedModal=!0),this.loading=!1,console.log("post data",l)})).catch((e=>{console.error("Error capturing screenshot:",e)}))}}},ot=l(3663),rt=l(7180),st=l(1248);const ct=(0,ne.A)(at,[["render",Ge]]);var nt=ct;he()(at,"components",{QCard:ot.A,QCardSection:rt.A,QCardActions:st.A,QIcon:pe.A,QBtn:be.A});const it={class:"q-px-2"},dt={class:"text-subtitle1 q-pt-md q-mb-none"},ut={class:"text-subtitle1 q-pt-md q-pb-md"},pt={class:"q-px-sm"},mt={class:"slider-markers"},bt=["onClick"],gt={class:"text-subtitle1 q-pb-md"},yt={class:"q-px-sm"},ht={class:"text-subtitle1"},ft={class:"text-subtitle1 q-mt-md"},vt={class:"text-subtitle1 q-mt-md"},kt={key:1,class:"text-subtitle1"};function xt(e,t,l,a,s,c){const n=(0,o.g2)("q-tooltip"),i=(0,o.g2)("q-btn"),d=(0,o.g2)("q-btn-group"),u=(0,o.g2)("q-slider"),p=(0,o.g2)("q-input"),m=(0,o.g2)("q-item-label"),b=(0,o.g2)("q-item-section"),g=(0,o.g2)("q-item"),y=(0,o.g2)("q-select"),h=(0,o.g2)("q-color");return(0,o.uX)(),(0,o.CE)("div",it,[e.selectedLayer.layerId?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.bF)(d,{push:"",spread:""},{default:(0,o.k6)((()=>[(0,o.bF)(i,{push:"",icon:"vertical_align_center",onClick:t[0]||(t[0]=t=>e.selectedLayer.centerH()),class:"q-px-none icon-rotate-90"},{default:(0,o.k6)((()=>[(0,o.bF)(n,{class:"bg-blue-8 text-body2",anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.$t("label.centerVertically")),1)])),_:1})])),_:1}),(0,o.bF)(i,{push:"",icon:"vertical_align_center",onClick:t[1]||(t[1]=t=>e.selectedLayer.centerV()),class:"q-px-none"},{default:(0,o.k6)((()=>[(0,o.bF)(n,{class:"bg-blue-8 text-body2",anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.$t("label.centerHorizontally")),1)])),_:1})])),_:1}),(0,o.bF)(i,{push:"",icon:"flip",onClick:t[2]||(t[2]=e=>c.setBoolProp("flipX")),class:"q-px-none"},{default:(0,o.k6)((()=>[(0,o.bF)(n,{class:"bg-blue-8 text-body2",anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.$t("label.flipHorizontally")),1)])),_:1})])),_:1}),(0,o.bF)(i,{push:"",icon:"flip",onClick:t[3]||(t[3]=e=>c.setBoolProp("flipY")),class:"q-px-none icon-rotate-90"},{default:(0,o.k6)((()=>[(0,o.bF)(n,{class:"bg-blue-8 text-body2",anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.$t("label.flipVertically")),1)])),_:1})])),_:1}),(0,o.bF)(i,{push:"",icon:"move_up",onClick:c.bringToFront,class:"q-px-none"},{default:(0,o.k6)((()=>[(0,o.bF)(n,{class:"bg-blue-8 text-body2",anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.$t("label.layerUp")),1)])),_:1})])),_:1},8,["onClick"]),(0,o.bF)(i,{push:"",icon:"move_up",onClick:c.sendToBack,class:"q-px-none icon-rotate-180"},{default:(0,o.k6)((()=>[(0,o.bF)(n,{class:"bg-blue-8 text-body2",anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.$t("label.layerDown")),1)])),_:1})])),_:1},8,["onClick"])])),_:1}),(0,o.Lk)("p",dt,(0,r.v_)(e.$t("text.dblClickForCrop")),1),(0,o.Lk)("p",ut,(0,r.v_)(e.$t("label.rotate")),1),(0,o.Lk)("div",pt,[(0,o.bF)(u,{modelValue:e.selectedLayer.angle,"onUpdate:modelValue":t[4]||(t[4]=t=>e.selectedLayer.angle=t),min:0,max:360,step:1,label:"","label-always":"",markers:90,"marker-labels":[{value:0,label:"0"},{value:90,label:"90"},{value:180,label:"180"},{value:270,label:"270"},{value:360,label:"360"}],color:"primary"},{"marker-label-group":(0,o.k6)((t=>[(0,o.Lk)("div",mt,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.markerList,(t=>((0,o.uX)(),(0,o.CE)("div",{key:t.index,class:(0,r.C4)(`marker-${t.value}`),onClick:l=>e.selectedLayer.angle=t.value},(0,r.v_)(t.value),11,bt)))),128))])])),_:1},8,["modelValue"])]),"text"==e.selectedLayer.layerType?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.Lk)("p",gt,(0,r.v_)(e.$t("label.size")),1),(0,o.Lk)("div",yt,[(0,o.bF)(u,{modelValue:e.scale,"onUpdate:modelValue":t[5]||(t[5]=t=>e.scale=t),min:0,max:5,step:.1,label:"","label-always":"","label-value":c.getFontSize(),color:"primary"},null,8,["modelValue","label-value"])]),(0,o.Lk)("p",ht,(0,r.v_)(e.$t("label.text")),1),(0,o.bF)(p,{filled:"",modelValue:e.selectedLayer.text,"onUpdate:modelValue":t[6]||(t[6]=t=>e.selectedLayer.text=t),type:"textarea","input-class":"layer-text-field"},null,8,["modelValue"]),(0,o.Lk)("p",ft,(0,r.v_)(e.$t("label.fontStyle")),1),(0,o.bF)(d,{push:"",spread:""},{default:(0,o.k6)((()=>[(0,o.bF)(i,{push:"",icon:"format_bold",onClick:c.setBold,class:(0,r.C4)({"bg-primary text-white":c.isBold()})},null,8,["onClick","class"]),(0,o.bF)(i,{push:"",icon:"format_italic",onClick:c.setItalic,class:(0,r.C4)({"bg-primary text-white":c.isItalic()})},null,8,["onClick","class"]),(0,o.bF)(i,{push:"",icon:"format_underlined",onClick:t[7]||(t[7]=e=>c.setBoolProp("underline")),class:(0,r.C4)({"bg-primary text-white":e.selectedLayer.underline})},null,8,["class"])])),_:1}),(0,o.Lk)("p",vt,(0,r.v_)(e.$t("label.fontFamily")),1),(0,o.bF)(y,{filled:"",modelValue:e.selectedLayer.fontFamily,"onUpdate:modelValue":t[8]||(t[8]=t=>e.selectedLayer.fontFamily=t),options:["Roboto",...e.fonts]},{option:(0,o.k6)((e=>[(0,o.bF)(g,(0,r._B)((0,o.Ng)(e.itemProps)),{default:(0,o.k6)((()=>[(0,o.bF)(b,null,{default:(0,o.k6)((()=>[(0,o.bF)(m,{style:(0,r.Tr)({"font-family":e.label})},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.label),1)])),_:2},1032,["style"])])),_:2},1024)])),_:2},1040)])),_:1},8,["modelValue","options"]),(0,o.bF)(h,{modelValue:e.selectedLayer.fill,"onUpdate:modelValue":t[9]||(t[9]=t=>e.selectedLayer.fill=t),"no-header-tabs":"","no-footer":"",class:"q-mt-md color-picker"},null,8,["modelValue"])],64)):(0,o.Q3)("",!0)],64)):((0,o.uX)(),(0,o.CE)("p",kt,(0,r.v_)(e.$t("text.selectObjectForCustomization")),1))])}var Ct={name:"ObjectDetails",inject:["ctx"],data:()=>({fonts:Z,scale:1}),computed:{...(0,m.aH)("canvas",["selectedLayer"]),grayscale:D.filter("Grayscale"),sepia:D.filter("Sepia"),invert:D.filter("Invert"),blackwhite:D.filter("BlackWhite"),brownie:D.filter("Brownie"),vintage:D.filter("Vintage"),polaroid:D.filter("Polaroid")},watch:{selectedLayer:{handler(){this.scale=this.selectedLayer.scaleX,this.selectedLayer.angle=parseInt(this.selectedLayer.angle),this.ctx.canvas.getActiveObject()&&(this.ctx.canvas.getActiveObject().dirty=!0,this.ctx.canvas.renderAll())},deep:!0},scale(e){this.selectedLayer.scaleX=e,this.selectedLayer.scaleY=e}},methods:{isBold(){return"bold"==this.selectedLayer.fontWeight},isItalic(){return"italic"==this.selectedLayer.fontStyle},setBold(){this.ctx.canvas.getActiveObject()&&(this.selectedLayer.fontWeight=this.isBold()?"normal":"bold")},setItalic(){this.ctx.canvas.getActiveObject()&&(this.selectedLayer.fontStyle=this.isItalic()?"normal":"italic")},setBoolProp(e){this.ctx.canvas.getActiveObject()&&(this.selectedLayer[e]=!this.selectedLayer[e])},bringToFront(){this.ctx.canvas.bringToFront(this.ctx.canvas.getActiveObject()),this.ctx.canvas.renderAll()},sendToBack(){this.ctx.canvas.sendToBack(this.ctx.canvas.getActiveObject()),this.ctx.canvas.renderAll()},getFontSize(){return parseInt(this.ctx.canvas.getActiveObject().scaleX*D.fontSize)+"px"}}},Lt=l(7877),At=l(6997),St=l(2851),Ft=l(4985),_t=l(3768),wt=l(7596);const It=(0,ne.A)(Ct,[["render",xt]]);var Mt=It;he()(Ct,"components",{QBtnGroup:Lt.A,QBtn:be.A,QTooltip:At.A,QSlider:St.A,QInput:Ft.A,QSelect:_t.A,QItem:ie.A,QItemSection:de.A,QItemLabel:me.A,QColor:wt.A});var qt={name:"ControlsPanel",components:{SelectedModel:nt,ObjectDetails:Mt},computed:{...(0,m.aH)("app",["controlTab"]),tab:{get(){return this.controlTab},set(e){this.setControlTab(e)}}},methods:{...(0,m.PY)("app",["setControlTab"])}};const jt=(0,ne.A)(qt,[["render",De]]);var Pt=jt;function Ot(e,t,l,a,s,c){const n=(0,o.g2)("q-spinner"),i=(0,o.g2)("q-card-section"),d=(0,o.g2)("q-card"),u=(0,o.g2)("q-dialog");return(0,o.uX)(),(0,o.Wv)(u,{modelValue:c.dialog,"onUpdate:modelValue":t[0]||(t[0]=e=>c.dialog=e),persistent:""},{default:(0,o.k6)((()=>[(0,o.bF)(d,null,{default:(0,o.k6)((()=>[(0,o.bF)(i,null,{default:(0,o.k6)((()=>[(0,o.bF)(n,{color:"primary",size:"2em",class:"q-mr-md"}),(0,o.eW)(" "+(0,r.v_)(e.$t("text.loadingAppState")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"])}he()(qt,"components",{QTabs:qe.A,QTab:je.A,QTabPanels:Pe.A,QTabPanel:Oe.A});var Tt={name:"InitModal",computed:{...(0,m.aH)("product",["models"]),dialog:{get(){return 0===this.models.length},set(){}}}},Qt=l(5704);const Xt=(0,ne.A)(Tt,[["render",Ot]]);var Wt=Xt;he()(Tt,"components",{QDialog:Qt.A,QCard:ot.A,QCardSection:rt.A,QSpinner:Ce.A});var Vt={name:"LayoutDefault",inject:["ctx"],components:{LayersPanel:Qe,ControlsPanel:Pt,ModeSelector:He,InitModal:Wt},mounted(){const e=new URL(window.location.href),t=e.searchParams.get("product_id"),l=e.searchParams.get("project_id");this.loadProductModels(t,l);const a=this.$refs.canvas;this.ctx.canvas=new b.fabric.Canvas(a,{selection:!1,allowTouchScrolling:!0}),this.ctx.canvas.on("before:selection:cleared",(()=>{this.resetSelectedLayer(),this.setControlTab("product")})),this.ctx.canvas.on("selection:created",(e=>{this.handleSelection(e)})),this.ctx.canvas.on("selection:updated",(e=>{this.handleSelection(e)})),this.ctx.canvas.on("object:modified",(e=>{"scale"!==e.action&&"rotate"!==e.action||(this.selectedLayer.dirty=!0)})),this.ctx.canvas.on({"object:added":()=>this.syncLayers(this.ctx.canvas.getObjects()),"object:removed":()=>this.syncLayers(this.ctx.canvas.getObjects())}),this.ctx.canvas.on("mouse:dblclick",(({target:e})=>{e&&"image"===e.type&&D.prepareCrop(e)})),document.addEventListener("keydown",(e=>{if(["Delete","Backspace"].includes(e.key)&&this.selectedLayer.layerId){if(document.querySelector(".layer-text-field")?.matches(":focus"))return;D.removeLayer(this.selectedLayer)}})),J().load(ee)},computed:{...(0,m.aH)("app",["user"]),...(0,m.aH)("canvas",["selectedLayer"]),...(0,m.aH)("product",["selectedModelColor"]),...(0,m.L8)("product",["selectedModelColorUrl"]),...(0,m.L8)("product",["selectedModelCoordinated"])},watch:{user(e){this.loadProductModels(e?.id)},selectedModelColorUrl(e){this.ctx.canvas.setHeight(this.selectedModelCoordinated.height),this.ctx.canvas.setWidth(this.selectedModelCoordinated.width),this.ctx.canvas.renderAll()}},methods:{...(0,m.PY)("app",["setUser","setControlTab"]),...(0,m.PY)("order",["setPricing"]),...(0,m.PY)("canvas",["syncLayers","setSelectedLayer","resetSelectedLayer"]),...(0,m.PY)("product",["setModels"]),handleSelection(e){let t=e.selected[0];this.selectedLayer.layerId!=t.layerId&&(this.setSelectedLayer(t),this.setControlTab("object"))},async loadProductModels(e,t){let l=await R.getModel(e,t);this.setModels(l)},async logout(){await M.logout(),window.location.reload()},setLanguage(e){this.$i18n.locale=e,C(e)}}},Et=l(7347),Ut=l(6284),Yt=l(1399);const $t=(0,ne.A)(Vt,[["render",p]]);var zt=$t;he()(Vt,"components",{QLayout:Et.A,QPageContainer:Ut.A,QPage:Yt.A});var Bt=l(5139);w.A.registerType("error",{color:"negative",icon:"error"}),w.A.registerType("success",{color:"positive",icon:"check_circle"}),w.A.registerType("orderSuccess",{color:"positive",position:"center"});var Ht={plugins:{Notify:w.A},config:{notify:{position:"top-right",timeout:2500,progress:!0}}};(0,a.Ef)(zt).use(Bt.A,Ht).use(Y).use(L).provide("ctx",B).mount("#app")},6574:function(){},2748:function(){},2246:function(){}},t={};function l(a){var o=t[a];if(void 0!==o)return o.exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,l),r.exports}l.m=e,function(){var e=[];l.O=function(t,a,o,r){if(!a){var s=1/0;for(d=0;d<e.length;d++){a=e[d][0],o=e[d][1],r=e[d][2];for(var c=!0,n=0;n<a.length;n++)(!1&r||s>=r)&&Object.keys(l.O).every((function(e){return l.O[e](a[n])}))?a.splice(n--,1):(c=!1,r<s&&(s=r));if(c){e.splice(d--,1);var i=o();void 0!==i&&(t=i)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[a,o,r]}}(),function(){l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,{a:t}),t}}(),function(){l.d=function(e,t){for(var a in t)l.o(t,a)&&!l.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){l.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};l.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,r,s=a[0],c=a[1],n=a[2],i=0;if(s.some((function(t){return 0!==e[t]}))){for(o in c)l.o(c,o)&&(l.m[o]=c[o]);if(n)var d=n(l)}for(t&&t(a);i<s.length;i++)r=s[i],l.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return l.O(d)},a=self["webpackChunkrtp_print_designer"]=self["webpackChunkrtp_print_designer"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=l.O(void 0,[504],(function(){return l(5336)}));a=l.O(a)})();
//# sourceMappingURL=app.91797e7c.js.map