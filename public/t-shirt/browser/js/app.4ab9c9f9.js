(function(){var e={859:function(e,t,l){"use strict";var a=l(9798),o=l(4220),r=l(7700);const s={class:"row"},c={class:"col-md-3 col-sm-12 sm-full-width"},n={class:"col-md-6 col-sm-12 canvas-column"},i={class:"canvas-designer"},d={class:"flex flex-center"},u={style:{border:"1px solid #e0e0e066",borderRadius:"5px"},ref:"canvas"},p={class:"col-md-3 col-sm-12 order-sm-last sm-full-width"};function m(e,t,l,a,m,b){const g=(0,o.g2)("LayersPanel"),y=(0,o.g2)("ModeSelector"),h=(0,o.g2)("ControlsPanel"),f=(0,o.g2)("q-page"),v=(0,o.g2)("q-page-container"),k=(0,o.g2)("q-layout"),x=(0,o.g2)("InitModal");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(k,{view:"lHh Lpr lFf"},{default:(0,o.k6)((()=>[(0,o.bF)(v,null,{default:(0,o.k6)((()=>[(0,o.bF)(f,{padding:""},{default:(0,o.k6)((()=>[(0,o.Lk)("div",s,[(0,o.Lk)("div",c,[(0,o.bF)(g)]),(0,o.Lk)("div",n,[(0,o.Lk)("div",i,[(0,o.bF)(y),(0,o.Lk)("div",d,[(0,o.Lk)("div",{class:"canvas-wrapper",style:(0,r.Tr)({backgroundImage:e.selectedModelColorUrl?`url('${e.selectedModelColorUrl}')`:null})},[(0,o.Lk)("div",{class:"canvas-block",style:(0,r.Tr)({height:e.selectedModelCoordinated?.height+"px",width:e.selectedModelCoordinated?.width+"px",top:e.selectedModelCoordinated?.top+"px",left:e.selectedModelCoordinated?.left+"px"})},[(0,o.Lk)("canvas",u,null,512)],4)],4)])])]),(0,o.Lk)("div",p,[(0,o.bF)(h)])])])),_:1})])),_:1})])),_:1}),(0,o.bF)(x)],64)}l(6734),l(7797),l(968);var b=l(3937),g=l(7599),y=l(7449);const h={"label.login":"Login","label.logout":"Logout","label.createAccount":"Create account","label.register":"Register","label.name":"Name","label.email":"Email","label.password":"Password","label.yes":"Yes","label.no":"No","label.layers":"Layers","label.files":"Files","label.projects":"Projects","label.image":"Image","label.text":"Text","label.loading":"Loading...","label.save":"Save","label.saveAs":"Save as","label.cancel":"Cancel","label.title":"Title","label.required":"Required","label.frontSide":"Front","label.backSide":"Back","label.select":"Select","label.create":"Create","label.delete":"Delete","label.selectModel":"Select model","label.product":"Product","label.object":"Object","label.catalog":"Catalog","label.createOwn":"Create your own","label.color":"Color","label.price":"Price","label.size":"Size","label.quantity":"Quantity","label.total":"Total","label.order":"Add to Card","label.phone":"Phone number","label.send":"Send","label.centerVertically":"Center vertically","label.centerHorizontally":"Center horizontally","label.flipHorizontally":"Flip horizontally","label.flipVertically":"Flip vertically","label.layerUp":"Layer up","label.layerDown":"Layer down","label.rotate":"Rotate","label.fontStyle":"Font style","label.fontFamily":"Font family","label.byAgreement":"By agreement","text.loadingAppState":"Loading app state","text.selectObjectForCustomization":"Select an object to edit its parameters","text.loginForProjects":"To save/load a project you need to","text.notSavedProjects":"You don't have any saved projects yet","text.confirmDelete":"Do you confirm deletion?","text.projectName":"Project name","text.applicationAccepted":"Application accepted","text.thanksApplicationAccepted":"Thank you, your application has been accepted!","text.weWillContactYou":"We will contact you shortly.","text.orderBeingProcessed":"Please wait while your order is being processed.","text.canTakeSometime":"It can take some time.","text.successfullyCreated":"Successfully created","text.successfullyDeleted":"Successfully deleted","text.successfullyUpdated":"Successfully updated","text.successfullyloggedIn":"You are successfully logged in","text.dblClickForCrop":"Double click on image to start cropping","text.error.emptyName":"The name cannot be empty","text.error.emptyTitle":"The title cannot be empty","text.error.emptyPhone":"Fill in your phone number","text.error.invalidEmail":"Invalid email","text.error.shortPassword":"The password must contain at least 8 characters","text.error.cantUploadFile":"Failed to upload file to server","text.error.errorOccurred":"An error has occurred. Please try again later.","text.error.invalidEmailOrPassword":"Invalid email or password","text.error.emailAlreadyUsed":"A user with this email already exists",xxx:"yyy"};var f=h;const v={"label.login":"Войти","label.logout":"Выйти","label.createAccount":"Создать аккаунт","label.register":"Зарегистрироваться","label.name":"Имя","label.email":"Email","label.password":"Пароль","label.yes":"Да","label.no":"Нет","label.layers":"Слои","label.files":"Файлы","label.projects":"Проекты","label.image":"изображение","label.text":"Текст","label.loading":"Загрузка...","label.save":"Сохранить","label.saveAs":"Сохр. как","label.cancel":"Отментиь","label.title":"Название","label.required":"Обязательно","label.frontSide":"Передняя","label.backSide":"Задняя","label.select":"Выбрать","label.create":"Создать","label.delete":"Удалить","label.selectModel":"Выберите модель","label.product":"Продукт","label.object":"Объект","label.catalog":"Каталог","label.createOwn":"Создать свой","label.color":"Цвет","label.price":"Цена","label.size":"Размер","label.quantity":"Kоличество","label.total":"Общее","label.order":"Заказать","label.phone":"Номер телефона","label.send":"Отправить","label.centerVertically":"Центрировать по вертикали","label.centerHorizontally":"Центрировать по горизонтали","label.flipHorizontally":"Отразить по горизонтали","label.flipVertically":"Отразить по вертикали","label.layerUp":"Слой вверх","label.layerDown":"Слой вниз","label.rotate":"Поворот","label.fontStyle":"Стиль фонта","label.fontFamily":"Фонт","label.byAgreement":"По соглашению","text.loadingAppState":"Загрузка состояния приложения","text.selectObjectForCustomization":"Выберите объект для редактирования его параметров","text.loginForProjects":"Чтобы сохранить/загрузить проект нужно","text.notSavedProjects":"У вас еще нет сохраненных проектов","text.confirmDelete":"Подтверждаете удаление ?","text.projectName":"Название проекта","text.applicationAccepted":"Заявка принята","text.thanksApplicationAccepted":"Спасибо, ваша заявка принята!","text.weWillContactYou":"Мы свяжемся с вами в ближайшее время.","text.orderBeingProcessed":"Пожалуйста подождите, ваш заказ обрабатывается.","text.canTakeSometime":"Это может занять некоторое время.","text.successfullyCreated":"Успещно создан","text.successfullyDeleted":"Успещно удалена","text.successfullyUpdated":"Успещно обновлен","text.successfullyloggedIn":"Вы успешно авторизованы","text.dblClickForCrop":"Дважды щелкните по изображению, чтобы начать обрезку","text.error.emptyName":"Имя не может быть пустым","text.error.emptyTitle":"Название не может быть пустым","text.error.emptyPhone":"Заполните номер телефона","text.error.invalidEmail":"Неверный e-mail","text.error.shortPassword":"Пароль должен содержать не менее 8 символов","text.error.cantUploadFile":"Не удалось загрузить файл на сервер","text.error.errorOccurred":"Произошла ошибка. Повторите попытку позже","text.error.invalidEmailOrPassword":"Неверный email или пароль","text.error.emailAlreadyUsed":"Пользователь с таким email уже существует",xxx:"yyy"};var k=v;const x={en:f,ru:k},C=()=>{const e=localStorage.getItem("app_lang");return x[e]?e:"en"},L=e=>{localStorage.setItem("app_lang",e)},A=(0,y.hU)({locale:C(),messages:x}),{t:F}=A.global;var S=l(4413);const w=S.A.create({baseURL:"https://app.print-rtp.ru/api/"});w.interceptors.request.use((e=>{const t="a1b2c3d4e5f6789abc0d1234567890abc";return t&&(e.headers["Authorization"]=`Bearer ${t}`),e}),(e=>Promise.reject(e)));var I=w,_=l(5110);const M={async getProfile(){try{let e=await I.get("users/me");return e.data.user}catch(e){return localStorage.removeItem("accessToken"),!1}},async login(e,t){try{let l=await I.post("users/login",{email:e,password:t});return localStorage.setItem("accessToken",l.data.token),_.A.create({type:"success",message:F("text.successfullyloggedIn")}),l.data.user}catch(l){return _.A.create({type:"error",message:F("text.invalidEmailOrPassword")}),!1}},async register(e,t,l){try{return await I.post("users",{name:e,email:t,password:l}),this.login(t,l)}catch(a){return _.A.create({type:"error",message:F("text.error.emailAlreadyUsed")}),!1}},async logout(){try{await I.post("users/logout")}catch(e){}localStorage.removeItem("accessToken"),localStorage.removeItem("appUser")}};var q=M;const P={async getPrices(){try{let e=await I.get("globals/pricing");return e.data}catch(e){return!1}},async create(e){try{let t=await I.post("orders?depth=0",e);return t.data.doc}catch(t){return _.A.create({type:"error",message:F("text.error.errorOccurred")}),!1}}};var j=P,O=l(7119);l(4645),l(9063),l(3665),l(988);const T={get:(e,t=null)=>{try{let l=JSON.parse(localStorage.getItem(e));"object"===typeof l&&null!==l&&(t=l)}catch(l){t=null}return t},set:(e,t)=>{localStorage.setItem(e,JSON.stringify(t))}},Q=g.fabric.Canvas.prototype._onTouchStart;g.fabric.util.object.extend(g.fabric.Canvas.prototype,{_onTouchStart:function(e){var t=this.findTarget(e);(!this.allowTouchScrolling||t||this.isDrawingMode)&&Q.call(this,e)}});const X=e=>{const t=Object.create(Object.getPrototypeOf(e)),l=Object.getOwnPropertyDescriptors(e);for(let a in l)l[a].hasOwnProperty("value")?t[a]=l[a].value:t[a]=l[a];return t};var W={namespaced:!0,state(){return{user:T.get("appUser"),projects:[],selectedProjectId:null,projectsFetched:!1,controlTab:"product",authModalOpened:!1,uploadedImages:T.get("print-uploaded-images",[])}},mutations:{setUser(e,t){e.user={id:t.id,name:t.name},T.set("appUser",e.user)},setProjects(e,t){e.projects=t},pushProject(e,t){e.projects.unshift(t)},deleteProject(e,t){e.projects=e.projects.filter((e=>e.id!=t))},setSelectedProjectId(e,t){e.selectedProjectId=t},setProjectsFetched(e,t){e.projectsFetched=t},setControlTab(e,t){e.controlTab=t},pushUploadedImage(e,t){e.uploadedImages.push(t),T.set("print-uploaded-images",e.uploadedImages)},removeUploadedImage(e,t){e.uploadedImages=e.uploadedImages.filter((e=>e.id!=t)),T.set("print-uploaded-images",e.uploadedImages)}}},V=(l(757),{namespaced:!0,state(){return{pricing:{},price:0,sizes:{xs:0,s:0,m:0,l:0,xl:0,xxl:0}}},mutations:{setPrice(e,t){e.price=t},setPricing(e,t){e.pricing=t}},getters:{quantity(e,t,l){return l.product.selectedModel.clientModel?1:Object.values(e.sizes).reduce(((e,t)=>parseInt(e)+parseInt(t)),0)}},actions:{calculatePrice({state:e,getters:t,commit:l,rootState:a}){let o=0,r=t.quantity,s=a.canvas.layers.length,c=a.product.selectedModel;if(!c.clientModel){if(r>z(c.prices))return void l("setPrice",F("label.byAgreement"));o=U(c.prices,r)}if(s>z(e.pricing.prices))return void l("setPrice",F("label.byAgreement"));let n=U(e.pricing.prices,s)*s,i=(o+n)*r;i=Math.round(i),l("setPrice",i)}}});const U=(e=[],t)=>{let l=e.filter((e=>e.from<=t&&e.to>=t));return l.length>0?l[0].value:0},z=(e=[])=>e.length>0?e[e.length-1].to:0;var $={namespaced:!0,state(){return{mode:"front",layers:[],selectedLayer:E()}},mutations:{setMode(e,t){e.mode=t},syncLayers(e,t){e.layers=t,this.dispatch("order/calculatePrice")},setSelectedLayer(e,t){e.controlTab="object",e.selectedLayer=t},resetSelectedLayer(e){e.controlTab="product",e.selectedLayer=E()}}};const E=()=>({layerId:null,layerType:null,text:null,fill:null,fontSize:null,fontWeight:"normal",fontStyle:"normal",underline:!1,fontFamily:null,angle:0,flipX:!1,flipY:!1,scaleAndZoom:0});var Y={namespaced:!0,state(){return{models:[],selectedModel:null,selectedModelColor:null}},mutations:{setModels(e,t){e.models=t,e.selectedModel||(e.selectedModel=t[0],e.selectedModelColor=e.selectedModel.images[0])},pushModel(e,t){e.models.push(t)},deleteModel(e,{id:t}){e.models=e.models.filter((e=>e.id!=t)),e.selectedModel.id==t&&this.commit("product/setModels",e.models)},setSelectedModel(e,t){e.selectedModel=t,e.selectedModelColor=e.selectedModel.images[0],this.dispatch("order/calculatePrice")},setSelectedModelColor(e,t){e.selectedModelColor=t},selectFristModel(e){this.commit("product/setSelectedModel",e.models[0])}},getters:{selectedModelColorUrl(e,t,l){return e.selectedModelColor?e.selectedModelColor[l.canvas.mode].url:null},selectedModelCoordinated(e,t,l){return e.selectedModelColor?{top:+e.selectedModelColor[l.canvas.mode].top,left:+e.selectedModelColor[l.canvas.mode].left,height:+e.selectedModelColor[l.canvas.mode].height,width:+e.selectedModelColor[l.canvas.mode].width}:null}}};const H=(0,b.y$)({modules:{app:W,order:V,canvas:$,product:Y}}),B={async upload(e){try{let t=await I.post("https://demo.yansprint.com/api/file-preview",e);return t.data}catch(t){return _.A.create({type:"error",message:F("text.error.cantUploadFile")}),!1}},async uploadBlob(e){try{let t=new FormData;t.append("file",e,"capture.png");let l=await I.post("media",t,{headers:{"Content-Type":"multipart/form-data"}});return l.data.doc}catch(t){return _.A.create({type:"error",message:F("text.error.cantUploadFile")}),!1}}};var D=B;const N={canvas:null};class R{static drawSelectedModel(){const e=N.canvas.getCenter();N.canvas.setBackgroundImage(H.getters["product/selectedModelColorUrl"],(e=>(N.canvas.backgroundImage.scaleX=N.canvas.getWidth()/e.width*R.scale,N.canvas.backgroundImage.scaleY=N.canvas.getHeight()/e.height*R.scale,N.canvas.renderAll())),{backgroundImageOpacity:1,backgroundImageStretch:!1,top:e.top,left:e.left,originX:"center",originY:"center",crossOrigin:"anonymous"}),N.canvas.renderAll()}static addTextLayer(e="Print Designer"){let t=N.canvas.getCenter(),l=new g.fabric.Text(e,{layerId:Date.now(),layerType:"text",mode:H.state.canvas.mode,fill:"#000000",fontSize:R.fontSize,fontFamily:"Lato",scaleX:1,scaleY:1,top:t.top,left:t.left,originX:"center",originY:"center",borderColor:"#3474d4",cornerColor:"#3474d4",strokeWidth:20,cornerSize:15,transparentCorners:!1,_controlsVisibility:{mt:!1,mb:!1,ml:!1,mr:!1}});N.canvas.add(l),N.canvas.setActiveObject(l),N.canvas.renderAll()}static addImageLayer(e){g.fabric.Image.fromURL(e,(e=>{e.set({layerId:Date.now(),layerType:"image",mode:H.state.canvas.mode,borderColor:"#3474d4",cornerColor:"#3474d4",strokeWidth:20,cornerSize:15,transparentCorners:!1,_controlsVisibility:{mt:!1,mb:!1,ml:!1,mr:!1}});var t=.35*N.canvas.getWidth();e.scaleToWidth(t),N.canvas.add(e),N.canvas.centerObject(e),e.setCoords(),N.canvas.setActiveObject(e),N.canvas.renderAll()}),{crossOrigin:"anonymous"})}static changeMode(){N.canvas.getObjects().forEach((e=>{e.visible=e.mode==H.state.canvas.mode})),N.canvas.discardActiveObject(),N.canvas.renderAll()}static selectLayer(e,t=()=>{}){N.canvas.getObjects().forEach((l=>{l.layerId==e.layerId&&(N.canvas.setActiveObject(l),N.canvas.renderAll(),t(l))}))}static removeLayer(e){N.canvas.getObjects().forEach((t=>{t.layerId==e.layerId&&(N.canvas.remove(t),N.canvas.renderAll())}))}static duplicateLayer(e){N.canvas.getObjects().forEach((t=>{if(t.layerId==e.layerId){const e=X(t);e.set({layerId:Date.now(),left:e.left+10,top:e.top+10}),N.canvas.add(e),N.canvas.renderAll()}}))}static filter(e){return{get(){return!!this.selectedLayer.filters.filter((t=>t.type==e)).length},set(t){t?this.selectedLayer.filters.push(new g.fabric.Image.filters[e]):this.selectedLayer.filters=this.selectedLayer.filters.filter((t=>t.type!=e)),this.selectedLayer.applyFilters()}}}static toJSON(){return N.canvas.toJSON(["mode","layerId","layerType","_controlsVisibility"])}static loadFromJSON(e,t=()=>{}){N.canvas.loadFromJSON(e,t)}static deleteAllLayers(){N.canvas.getObjects().forEach((e=>{N.canvas.remove(e)}))}static async takeVirtualCapture(e){let t=new g.fabric.Canvas(null,{width:N.canvas.width,height:N.canvas.height});return new Promise((l=>{t.loadFromJSON(this.toJSON(),(()=>{t.getObjects().forEach((t=>{t.visible=t.mode==e}));const a=t.getCenter();t.setBackgroundImage(H.state.product.selectedModelColor[e].url,(e=>{t.backgroundImage.scaleX=t.getWidth()/e.width*R.scale,t.backgroundImage.scaleY=t.getHeight()/e.height*R.scale,t.renderAll().getElement().toBlob((e=>{l(e)}),"image/png",1)}),{backgroundImageOpacity:1,backgroundImageStretch:!1,scaleX:.35,scaleY:.35,top:a.top,left:a.left,originX:"center",originY:"center",crossOrigin:"anonymous"})}))}))}static async capture(){let e,t,l=await this.takeVirtualCapture("front");if(e=await D.uploadBlob(l),console.log(H.state.product.selectedModelColor.back),H.state.product.selectedModelColor.back){let e=await this.takeVirtualCapture("back");t=await D.uploadBlob(e)}return{front:e,back:t}}static prepareCrop(e){var t=new g.fabric.Rect({id:"crop-rect",top:e.top,left:e.left,angle:e.angle,width:e.getScaledWidth(),height:e.getScaledHeight(),stroke:"rgb(42, 67, 101)",strokeWidth:2,strokeDashArray:[5,5],fill:"rgba(255, 255, 255, 1)",globalCompositeOperation:"overlay",lockRotation:!0}),l=new g.fabric.Rect({id:"overlay-rect",top:e.top,left:e.left,angle:e.angle,width:e.getScaledWidth(),height:e.getScaledHeight(),selectable:!1,selection:!1,fill:"rgba(0, 0, 0, 0.5)",lockRotation:!0}),a=e.cropX,o=e.cropY,r=e.width,s=e.height;e.set({cropX:null,cropY:null,left:e.left-a*e.scaleX,top:e.top-o*e.scaleY,width:e._originalElement.naturalWidth,height:e._originalElement.naturalHeight,dirty:!1}),t.set({left:e.left+a*e.scaleX,top:e.top+o*e.scaleY,width:r*e.scaleX,height:s*e.scaleY,dirty:!1}),l.set({left:e.left,top:e.top,width:e.width*e.scaleX,height:e.height*e.scaleY,dirty:!1}),t.oldScaleX=t.scaleX,t.oldScaleY=t.scaleY,N.canvas.add(l),N.canvas.add(t),N.canvas.discardActiveObject(),N.canvas.setActiveObject(t),N.canvas.renderAll(),t.on("moving",(function(){(t.top<e.top||t.left<e.left)&&(t.left=t.left<e.left?e.left:t.left,t.top=t.top<e.top?e.top:t.top),(t.top+t.getScaledHeight()>e.top+e.getScaledHeight()||t.left+t.getScaledWidth()>e.left+e.getScaledWidth())&&(t.top=t.top+t.getScaledHeight()>e.top+e.getScaledHeight()?e.top+e.getScaledHeight()-t.getScaledHeight():t.top,t.left=t.left+t.getScaledWidth()>e.left+e.getScaledWidth()?e.left+e.getScaledWidth()-t.getScaledWidth():t.left)})),t.on("deselected",(function(){R.cropImage(t,e),N.canvas.remove(l)}))}static cropImage(e,t){N.canvas.remove(e);const l=(e.left-t.left)/t.scaleX,a=(e.top-t.top)/t.scaleY,o=e.width*e.scaleX/t.scaleX,r=e.height*e.scaleY/t.scaleY;t.set({cropX:l,cropY:a,width:o,height:r,top:t.top+a*t.scaleY,left:t.left+l*t.scaleX,selectable:!0,cropped:1}),N.canvas.renderAll()}}(0,O.A)(R,"fontSize",16),(0,O.A)(R,"scale",1);var K=R;l(6029);const J={async getModel(e,t){try{let l=await I.get(`https://demo.yansprint.com/api/product/${e}?project_id=${t}`);return l.data.images.map((e=>{e[2]&&(e.front=e[2],delete e[2]),e[3]&&(e.back=e[3],delete e[3])})),[l.data]}catch(l){return!1}},async getModels(e=null){try{let t=await I.post("products/models",{userId:e});return t.data.docs}catch(t){return!1}},async create(e){try{let t=await I.post("products",e);return _.A.create({type:"success",message:F("text.successfullyCreated")}),t.data.doc}catch(t){return _.A.create({type:"error",message:F("text.error.errorOccurred")}),!1}},async delete(e){try{let t=await I.delete(`products/${e}`);return _.A.create({type:"success",message:F("text.successfullyDeleted")}),console.log("delete: ",t),!0}catch(t){return console.log("error:create: ",t),_.A.create({type:"error",message:F("text.error.errorOccurred")}),!1}}};var G=J,Z=l(3158),ee=l.n(Z);const te={google:{families:["Splash","Dancing Script","Oswald","Raleway","Lobster","Pacifico","Rubik Gemstones","Rubik Spray Paint","Rubik Vinyl","Caveat","Press Start 2P","Marck Script","Neucha","Kosugi Maru","Bad Script","Vollkorn SC"]},timeout:2e3},le=[...te.google.families];var ae=te;const oe={class:"text-grey-8 q-gutter-xs"};function re(e,t,l,s,c,n){const i=(0,o.g2)("q-tab"),d=(0,o.g2)("q-tabs"),u=(0,o.g2)("LayersList"),p=(0,o.g2)("q-tab-panel"),m=(0,o.g2)("q-img"),b=(0,o.g2)("q-item-section"),g=(0,o.g2)("q-item-label"),y=(0,o.g2)("q-btn"),h=(0,o.g2)("q-item"),f=(0,o.g2)("q-separator"),v=(0,o.g2)("q-list"),k=(0,o.g2)("q-tab-panels"),x=(0,o.gN)("ripple");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(d,{modelValue:e.tab,"onUpdate:modelValue":t[0]||(t[0]=t=>e.tab=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{name:"layers",label:e.$t("label.layers")},null,8,["label"]),(0,o.bF)(i,{name:"images",label:e.$t("label.files")},null,8,["label"])])),_:1},8,["modelValue"]),(0,o.bF)(k,{modelValue:e.tab,"onUpdate:modelValue":t[1]||(t[1]=t=>e.tab=t),animated:""},{default:(0,o.k6)((()=>[(0,o.bF)(p,{name:"layers",class:"q-px-none"},{default:(0,o.k6)((()=>[(0,o.bF)(u)])),_:1}),(0,o.bF)(p,{name:"images",class:"q-px-none"},{default:(0,o.k6)((()=>[(0,o.bF)(v,{bordered:"",separator:"",class:"scroll-area"},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.uploadedImages,(t=>(0,o.bo)(((0,o.uX)(),(0,o.Wv)(h,{key:t.id,onClick:e=>n.addToLayers(t.url),clickable:""},{default:(0,o.k6)((()=>[(0,o.bF)(b,{avatar:""},{default:(0,o.k6)((()=>[(0,o.bF)(m,{src:t.url,style:{height:"34px","max-width":"34px"}},null,8,["src"])])),_:2},1024),(0,o.bF)(b,{top:""},{default:(0,o.k6)((()=>[(0,o.bF)(g,{class:"q-mt-sm"},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.$t("label.image")),1)])),_:1})])),_:1}),(0,o.bF)(b,{avatar:"",side:""},{default:(0,o.k6)((()=>[(0,o.Lk)("div",oe,[(0,o.bF)(y,{class:"text-red",size:"12px",flat:"",dense:"",round:"",icon:"delete",onClick:(0,a.D$)((l=>e.removeUploadedImage(t.id)),["stop"])},null,8,["onClick"]),(0,o.bF)(y,{size:"12px",flat:"",dense:"",round:"",icon:"add"})])])),_:2},1024)])),_:2},1032,["onClick"])),[[x]]))),128)),(0,o.bo)((0,o.bF)(f,null,null,512),[[a.aG,e.uploadedImages.length]])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}const se={class:"q-pb-md q-px-2"};function ce(e,t,l,r,s,c){const n=(0,o.g2)("q-btn"),i=(0,o.g2)("LayerItem"),d=(0,o.g2)("LoadingItem"),u=(0,o.g2)("q-separator"),p=(0,o.g2)("q-list");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",se,[(0,o.bF)(n,{"no-caps":"",onClick:c.addTextLayer,color:"white","text-color":"black",icon:"add",label:e.$t("label.text"),class:"q-mr-sm"},null,8,["onClick","label"]),(0,o.bF)(n,{"no-caps":"",onClick:t[0]||(t[0]=e=>this.$refs.fileInput.click()),color:"primary",icon:"file_upload",label:e.$t("label.image")},null,8,["label"]),(0,o.Lk)("input",{ref:"fileInput",type:"file",onChange:t[1]||(t[1]=(...e)=>c.uploadImage&&c.uploadImage(...e)),class:"hidden"},null,544)]),(0,o.bF)(p,{bordered:"",separator:"",class:"scroll-area"},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.layers,(t=>((0,o.uX)(),(0,o.CE)(o.FK,{key:t.layerId},[t.mode==e.mode?((0,o.uX)(),(0,o.Wv)(i,{key:0,layer:t},null,8,["layer"])):(0,o.Q3)("",!0)],64)))),128)),e.loadingLayer?((0,o.uX)(),(0,o.Wv)(d,{key:0})):(0,o.Q3)("",!0),(0,o.bo)((0,o.bF)(u,null,null,512),[[a.aG,e.layers.length]])])),_:1})],64)}const ne={class:"text-black-8 q-gutter-xs"};function ie(e,t,l,s,c,n){const i=(0,o.g2)("q-img"),d=(0,o.g2)("q-icon"),u=(0,o.g2)("q-item-section"),p=(0,o.g2)("q-item-label"),m=(0,o.g2)("q-btn"),b=(0,o.g2)("q-item"),g=(0,o.gN)("ripple");return(0,o.bo)(((0,o.uX)(),(0,o.Wv)(b,{onClick:t[2]||(t[2]=e=>n.selectLayer(l.layer)),active:l.layer.layerId==e.selectedLayer.layerId,"active-class":"bg-accent text-black-8 active-layer",clickable:""},{default:(0,o.k6)((()=>[(0,o.bF)(u,{avatar:"",top:""},{default:(0,o.k6)((()=>["image"==l.layer.layerType?((0,o.uX)(),(0,o.Wv)(i,{key:0,src:l.layer._originalElement?.currentSrc,style:{height:"34px","max-width":"34px"}},null,8,["src"])):((0,o.uX)(),(0,o.Wv)(d,{key:1,name:"title",color:"black",size:"34px"}))])),_:1}),(0,o.bF)(u,{top:""},{default:(0,o.k6)((()=>["image"==l.layer.layerType?((0,o.uX)(),(0,o.Wv)(p,{key:0,class:"q-mt-sm"},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.$t("label.image")),1)])),_:1})):((0,o.uX)(),(0,o.Wv)(p,{key:1,class:"q-mt-sm layer-title"},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(l.layer.text),1)])),_:1}))])),_:1}),(0,o.bF)(u,{avatar:"",side:""},{default:(0,o.k6)((()=>[(0,o.Lk)("div",ne,[(0,o.bF)(m,{class:"text-secondary",size:"12px",flat:"",dense:"",icon:"content_copy",onClick:t[0]||(t[0]=(0,a.D$)((e=>n.duplicateLayer(l.layer)),["stop"]))}),(0,o.bF)(m,{class:"text-red",size:"12px",flat:"",dense:"",round:"",icon:"delete",onClick:t[1]||(t[1]=(0,a.D$)((e=>n.removeLayer(l.layer)),["stop"]))})])])),_:1})])),_:1},8,["active"])),[[g]])}var de={name:"LayerItem",inject:["ctx"],props:["layer"],data:()=>({}),computed:{...(0,b.aH)("canvas",["selectedLayer"])},methods:{...(0,b.PY)("canvas",["setSelectedLayer"]),selectLayer(e){K.selectLayer(e,(e=>{this.setSelectedLayer(e)}))},removeLayer(e){K.removeLayer(e)},duplicateLayer(e){K.duplicateLayer(e)}}},ue=l(1317),pe=l(5740),me=l(1484),be=l(5678),ge=l(4503),ye=l(2473),he=l(3197),fe=l(5408),ve=l(2110),ke=l.n(ve);const xe=(0,ue.A)(de,[["render",ie]]);var Ce=xe;function Le(e,t,l,a,s,c){const n=(0,o.g2)("q-spinner"),i=(0,o.g2)("q-item-section"),d=(0,o.g2)("q-item-label"),u=(0,o.g2)("q-item"),p=(0,o.gN)("ripple");return(0,o.bo)(((0,o.uX)(),(0,o.Wv)(u,null,{default:(0,o.k6)((()=>[(0,o.bF)(i,{avatar:"",top:""},{default:(0,o.k6)((()=>[(0,o.bF)(n,{color:"primary",size:"2em"})])),_:1}),(0,o.bF)(i,{top:"",class:"gt-sm"},{default:(0,o.k6)((()=>[(0,o.bF)(d,{class:"q-mt-sm"},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.$t("label.loading")),1)])),_:1})])),_:1})])),_:1})),[[p]])}ke()(de,"components",{QItem:pe.A,QItemSection:me.A,QImg:be.A,QIcon:ge.A,QItemLabel:ye.A,QBtn:he.A}),ke()(de,"directives",{Ripple:fe.A});var Ae={name:"LoadingItem"},Fe=l(6119);const Se=(0,ue.A)(Ae,[["render",Le]]);var we=Se;ke()(Ae,"components",{QItem:pe.A,QItemSection:me.A,QSpinner:Fe.A,QItemLabel:ye.A}),ke()(Ae,"directives",{Ripple:fe.A});var Ie={name:"LayersList",components:{LayerItem:Ce,LoadingItem:we},data:()=>({tab:"layers",loadingLayer:!1}),computed:{...(0,b.aH)("canvas",["layers","mode"])},methods:{...(0,b.PY)("app",["pushUploadedImage"]),addTextLayer(){K.addTextLayer()},addImageLayer(e){K.addImageLayer(e)},async uploadImage(e){let t=e.target.files[0];if(!t)return;this.loadingLayer=!0;let l=new FormData;l.append("file_preview",t);let a=await D.upload(l);a&&(this.addImageLayer(a.url),this.pushUploadedImage({id:Date.now(),url:a.url})),this.loadingLayer=!1}}},_e=l(5668),Me=l(5861);const qe=(0,ue.A)(Ie,[["render",ce]]);var Pe=qe;ke()(Ie,"components",{QBtn:he.A,QList:_e.A,QSeparator:Me.A});var je={name:"LayersPanel",components:{LayersList:Pe},data:()=>({tab:"layers"}),computed:{...(0,b.aH)("app",["uploadedImages"])},methods:{...(0,b.PY)("app",["removeUploadedImage"]),addToLayers(e){K.addImageLayer(e),this.tab="layers"}}},Oe=l(4591),Te=l(5713),Qe=l(588),Xe=l(9689);const We=(0,ue.A)(je,[["render",re]]);var Ve=We;ke()(je,"components",{QTabs:Oe.A,QTab:Te.A,QTabPanels:Qe.A,QTabPanel:Xe.A,QList:_e.A,QItem:pe.A,QItemSection:me.A,QImg:be.A,QItemLabel:ye.A,QBtn:he.A,QSeparator:Me.A}),ke()(je,"directives",{Ripple:fe.A});const Ue={class:"q-pa-md row items-start mode-selector"},ze={key:0,class:"selectors-wrapper"},$e=["src"],Ee=["src"];function Ye(e,t,l,a,s,c){return(0,o.uX)(),(0,o.CE)("div",Ue,[e.selectedModelColor?((0,o.uX)(),(0,o.CE)("div",ze,[(0,o.Lk)("div",{onClick:t[0]||(t[0]=t=>e.setMode("front")),class:(0,r.C4)([{active:"front"==e.mode},"selector-item"])},[(0,o.Lk)("img",{src:e.selectedModelColor.front.url,alt:""},null,8,$e)],2),e.selectedModelColor.back?((0,o.uX)(),(0,o.CE)("div",{key:0,onClick:t[1]||(t[1]=t=>e.setMode("back")),class:(0,r.C4)([{active:"back"==e.mode},"selector-item"])},[(0,o.Lk)("img",{src:e.selectedModelColor.back.url,alt:""},null,8,Ee)],2)):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)])}var He={name:"ModeSelector",computed:{...(0,b.aH)("canvas",["mode"]),...(0,b.aH)("product",["selectedModel","selectedModelColor"])},watch:{mode(){this.changeMode()},selectedModel(){"undefined"===typeof this.selectedModelColor.back&&this.setMode("front")}},methods:{...(0,b.PY)("canvas",["setMode"]),changeMode(){K.changeMode()}}};const Be=(0,ue.A)(He,[["render",Ye]]);var De=Be;function Ne(e,t,l,a,r,s){const c=(0,o.g2)("q-tab"),n=(0,o.g2)("q-tabs"),i=(0,o.g2)("SelectedModel"),d=(0,o.g2)("q-tab-panel"),u=(0,o.g2)("ObjectDetails"),p=(0,o.g2)("q-tab-panels");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(n,{modelValue:s.tab,"onUpdate:modelValue":t[0]||(t[0]=e=>s.tab=e),"inline-label":"",dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify"},{default:(0,o.k6)((()=>[(0,o.bF)(c,{name:"product",icon:"crop_original",label:e.$t("label.product")},null,8,["label"]),(0,o.bF)(c,{name:"object",icon:"tune",label:e.$t("label.object")},null,8,["label"])])),_:1},8,["modelValue"]),(0,o.bF)(p,{modelValue:s.tab,"onUpdate:modelValue":t[1]||(t[1]=e=>s.tab=e),animated:""},{default:(0,o.k6)((()=>[(0,o.bF)(d,{name:"product",class:"q-px-none"},{default:(0,o.k6)((()=>[(0,o.bF)(i)])),_:1}),(0,o.bF)(d,{name:"object",class:"q-px-none scroll-area"},{default:(0,o.k6)((()=>[(0,o.bF)(u)])),_:1})])),_:1},8,["modelValue"])],64)}const Re={class:"text-h6"},Ke={class:"text-subtitle1"},Je=["onClick"],Ge={class:"row justify-center q-mt-md"};function Ze(e,t,l,a,s,c){const n=(0,o.g2)("q-card-section"),i=(0,o.g2)("q-icon"),d=(0,o.g2)("q-card-actions"),u=(0,o.g2)("q-btn"),p=(0,o.g2)("q-card");return e.selectedModel?((0,o.uX)(),(0,o.Wv)(p,{key:0,class:"q-mx-2"},{default:(0,o.k6)((()=>[(0,o.bF)(n,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",Re,(0,r.v_)(e.selectedModel.title),1)])),_:1}),(0,o.bF)(n,null,{default:(0,o.k6)((()=>[(0,o.Lk)("p",Ke,(0,r.v_)(e.$t("label.color")),1),(0,o.bF)(d,{class:"colors"},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.selectedModel.images,(t=>((0,o.uX)(),(0,o.CE)("div",{key:t.front.url,onClick:l=>e.setSelectedModelColor(t),class:"cursor-pointer model-colors"},[e.selectedModelColor.id==t.id?((0,o.uX)(),(0,o.Wv)(i,{key:0,class:"check-icon",name:"check",size:"20px"})):(0,o.Q3)("",!0),(0,o.Lk)("div",{class:(0,r.C4)(["color",{active:e.selectedModelColor.id==t.id}]),style:(0,r.Tr)({background:t.hex})},null,6)],8,Je)))),128))])),_:1}),(0,o.Lk)("div",Ge,[(0,o.bF)(u,{"no-caps":"",color:"primary",icon:"shopping_basket",label:e.$t("label.order"),onClick:t[0]||(t[0]=t=>e.orderModal=!0),disabled:!c.canOrder()},null,8,["label","disabled"])])])),_:1})])),_:1})):(0,o.Q3)("",!0)}var et={name:"SelectedModel",data:()=>({orderModal:!1,orderCreatedModal:!1,loading:!1,phone:"",email:""}),watch:{sizes:{handler(){this.calculatePrice()},deep:!0}},computed:{...(0,b.aH)("app",["user","pricing"]),...(0,b.aH)("order",["price","sizes"]),...(0,b.aH)("product",["selectedModel","selectedModelColor"]),...(0,b.aH)("canvas",["layers"]),...(0,b.L8)("order",["quantity"])},methods:{...(0,b.PY)("product",["setSelectedModelColor"]),...(0,b.PY)("app",[]),...(0,b.i0)("order",["calculatePrice"]),canOrder(){return this.layers.length>0},quantityHtml(){let e="";for(let t in this.sizes)0!=this.sizes[t]&&(e+=`<b>${t.toUpperCase()}:</b> ${this.sizes[t]}<br/>`);return e},async createOrder(){if(!this.isValidPhone(this.phone))return void this.$refs.phoneInput.validate();if(!this.validateEmail(this.email))return void this.$refs.emailInput.validate();this.loading=!0;let e=await K.capture(),t=await j.create({title:"Order №"+Date.now(),clientModel:this.selectedModel.clientModel,phone:this.phone,email:this.email,price:this.price,quantity:this.quantityHtml(),front:e.front.id,back:e.back?e.back.id:null,json:JSON.stringify({sizes:this.sizes,model:this.selectedModelColor,canvasData:K.toJSON()})});t&&(this.orderModal=!1,this.orderCreatedModal=!0,this.phone="",this.email=""),this.loading=!1}}},tt=l(3663),lt=l(7180),at=l(1248);const ot=(0,ue.A)(et,[["render",Ze]]);var rt=ot;ke()(et,"components",{QCard:tt.A,QCardSection:lt.A,QCardActions:at.A,QIcon:ge.A,QBtn:he.A});const st={class:"q-px-2"},ct={class:"text-subtitle1 q-pt-md q-mb-none"},nt={class:"text-subtitle1 q-pt-md q-pb-md"},it={class:"q-px-sm"},dt={class:"slider-markers"},ut=["onClick"],pt={class:"text-subtitle1 q-pb-md"},mt={class:"q-px-sm"},bt={class:"text-subtitle1"},gt={class:"text-subtitle1 q-mt-md"},yt={class:"text-subtitle1 q-mt-md"},ht={key:1,class:"text-subtitle1"};function ft(e,t,l,a,s,c){const n=(0,o.g2)("q-tooltip"),i=(0,o.g2)("q-btn"),d=(0,o.g2)("q-btn-group"),u=(0,o.g2)("q-slider"),p=(0,o.g2)("q-input"),m=(0,o.g2)("q-item-label"),b=(0,o.g2)("q-item-section"),g=(0,o.g2)("q-item"),y=(0,o.g2)("q-select"),h=(0,o.g2)("q-color");return(0,o.uX)(),(0,o.CE)("div",st,[e.selectedLayer.layerId?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.bF)(d,{push:"",spread:""},{default:(0,o.k6)((()=>[(0,o.bF)(i,{push:"",icon:"vertical_align_center",onClick:t[0]||(t[0]=t=>e.selectedLayer.centerH()),class:"q-px-none icon-rotate-90"},{default:(0,o.k6)((()=>[(0,o.bF)(n,{class:"bg-blue-8 text-body2",anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.$t("label.centerVertically")),1)])),_:1})])),_:1}),(0,o.bF)(i,{push:"",icon:"vertical_align_center",onClick:t[1]||(t[1]=t=>e.selectedLayer.centerV()),class:"q-px-none"},{default:(0,o.k6)((()=>[(0,o.bF)(n,{class:"bg-blue-8 text-body2",anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.$t("label.centerHorizontally")),1)])),_:1})])),_:1}),(0,o.bF)(i,{push:"",icon:"flip",onClick:t[2]||(t[2]=e=>c.setBoolProp("flipX")),class:"q-px-none"},{default:(0,o.k6)((()=>[(0,o.bF)(n,{class:"bg-blue-8 text-body2",anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.$t("label.flipHorizontally")),1)])),_:1})])),_:1}),(0,o.bF)(i,{push:"",icon:"flip",onClick:t[3]||(t[3]=e=>c.setBoolProp("flipY")),class:"q-px-none icon-rotate-90"},{default:(0,o.k6)((()=>[(0,o.bF)(n,{class:"bg-blue-8 text-body2",anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.$t("label.flipVertically")),1)])),_:1})])),_:1}),(0,o.bF)(i,{push:"",icon:"move_up",onClick:c.bringToFront,class:"q-px-none"},{default:(0,o.k6)((()=>[(0,o.bF)(n,{class:"bg-blue-8 text-body2",anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.$t("label.layerUp")),1)])),_:1})])),_:1},8,["onClick"]),(0,o.bF)(i,{push:"",icon:"move_up",onClick:c.sendToBack,class:"q-px-none icon-rotate-180"},{default:(0,o.k6)((()=>[(0,o.bF)(n,{class:"bg-blue-8 text-body2",anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.$t("label.layerDown")),1)])),_:1})])),_:1},8,["onClick"])])),_:1}),(0,o.Lk)("p",ct,(0,r.v_)(e.$t("text.dblClickForCrop")),1),(0,o.Lk)("p",nt,(0,r.v_)(e.$t("label.rotate")),1),(0,o.Lk)("div",it,[(0,o.bF)(u,{modelValue:e.selectedLayer.angle,"onUpdate:modelValue":t[4]||(t[4]=t=>e.selectedLayer.angle=t),min:0,max:360,step:1,label:"","label-always":"",markers:90,"marker-labels":[{value:0,label:"0"},{value:90,label:"90"},{value:180,label:"180"},{value:270,label:"270"},{value:360,label:"360"}],color:"primary"},{"marker-label-group":(0,o.k6)((t=>[(0,o.Lk)("div",dt,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.markerList,(t=>((0,o.uX)(),(0,o.CE)("div",{key:t.index,class:(0,r.C4)(`marker-${t.value}`),onClick:l=>e.selectedLayer.angle=t.value},(0,r.v_)(t.value),11,ut)))),128))])])),_:1},8,["modelValue"])]),"text"==e.selectedLayer.layerType?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.Lk)("p",pt,(0,r.v_)(e.$t("label.size")),1),(0,o.Lk)("div",mt,[(0,o.bF)(u,{modelValue:e.scale,"onUpdate:modelValue":t[5]||(t[5]=t=>e.scale=t),min:0,max:5,step:.1,label:"","label-always":"","label-value":c.getFontSize(),color:"primary"},null,8,["modelValue","label-value"])]),(0,o.Lk)("p",bt,(0,r.v_)(e.$t("label.text")),1),(0,o.bF)(p,{filled:"",modelValue:e.selectedLayer.text,"onUpdate:modelValue":t[6]||(t[6]=t=>e.selectedLayer.text=t),type:"textarea","input-class":"layer-text-field"},null,8,["modelValue"]),(0,o.Lk)("p",gt,(0,r.v_)(e.$t("label.fontStyle")),1),(0,o.bF)(d,{push:"",spread:""},{default:(0,o.k6)((()=>[(0,o.bF)(i,{push:"",icon:"format_bold",onClick:c.setBold,class:(0,r.C4)({"bg-primary text-white":c.isBold()})},null,8,["onClick","class"]),(0,o.bF)(i,{push:"",icon:"format_italic",onClick:c.setItalic,class:(0,r.C4)({"bg-primary text-white":c.isItalic()})},null,8,["onClick","class"]),(0,o.bF)(i,{push:"",icon:"format_underlined",onClick:t[7]||(t[7]=e=>c.setBoolProp("underline")),class:(0,r.C4)({"bg-primary text-white":e.selectedLayer.underline})},null,8,["class"])])),_:1}),(0,o.Lk)("p",yt,(0,r.v_)(e.$t("label.fontFamily")),1),(0,o.bF)(y,{filled:"",modelValue:e.selectedLayer.fontFamily,"onUpdate:modelValue":t[8]||(t[8]=t=>e.selectedLayer.fontFamily=t),options:["Roboto",...e.fonts]},{option:(0,o.k6)((e=>[(0,o.bF)(g,(0,r._B)((0,o.Ng)(e.itemProps)),{default:(0,o.k6)((()=>[(0,o.bF)(b,null,{default:(0,o.k6)((()=>[(0,o.bF)(m,{style:(0,r.Tr)({"font-family":e.label})},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(e.label),1)])),_:2},1032,["style"])])),_:2},1024)])),_:2},1040)])),_:1},8,["modelValue","options"]),(0,o.bF)(h,{modelValue:e.selectedLayer.fill,"onUpdate:modelValue":t[9]||(t[9]=t=>e.selectedLayer.fill=t),"no-header-tabs":"","no-footer":"",class:"q-mt-md color-picker"},null,8,["modelValue"])],64)):(0,o.Q3)("",!0)],64)):((0,o.uX)(),(0,o.CE)("p",ht,(0,r.v_)(e.$t("text.selectObjectForCustomization")),1))])}var vt={name:"ObjectDetails",inject:["ctx"],data:()=>({fonts:le,scale:1}),computed:{...(0,b.aH)("canvas",["selectedLayer"]),grayscale:K.filter("Grayscale"),sepia:K.filter("Sepia"),invert:K.filter("Invert"),blackwhite:K.filter("BlackWhite"),brownie:K.filter("Brownie"),vintage:K.filter("Vintage"),polaroid:K.filter("Polaroid")},watch:{selectedLayer:{handler(){this.scale=this.selectedLayer.scaleX,this.selectedLayer.angle=parseInt(this.selectedLayer.angle),this.ctx.canvas.getActiveObject()&&(this.ctx.canvas.getActiveObject().dirty=!0,this.ctx.canvas.renderAll())},deep:!0},scale(e){this.selectedLayer.scaleX=e,this.selectedLayer.scaleY=e}},methods:{isBold(){return"bold"==this.selectedLayer.fontWeight},isItalic(){return"italic"==this.selectedLayer.fontStyle},setBold(){this.ctx.canvas.getActiveObject()&&(this.selectedLayer.fontWeight=this.isBold()?"normal":"bold")},setItalic(){this.ctx.canvas.getActiveObject()&&(this.selectedLayer.fontStyle=this.isItalic()?"normal":"italic")},setBoolProp(e){this.ctx.canvas.getActiveObject()&&(this.selectedLayer[e]=!this.selectedLayer[e])},bringToFront(){this.ctx.canvas.bringToFront(this.ctx.canvas.getActiveObject()),this.ctx.canvas.renderAll()},sendToBack(){this.ctx.canvas.sendToBack(this.ctx.canvas.getActiveObject()),this.ctx.canvas.renderAll()},getFontSize(){return parseInt(this.ctx.canvas.getActiveObject().scaleX*K.fontSize)+"px"}}},kt=l(7877),xt=l(6997),Ct=l(2851),Lt=l(4985),At=l(3768),Ft=l(7596);const St=(0,ue.A)(vt,[["render",ft]]);var wt=St;ke()(vt,"components",{QBtnGroup:kt.A,QBtn:he.A,QTooltip:xt.A,QSlider:Ct.A,QInput:Lt.A,QSelect:At.A,QItem:pe.A,QItemSection:me.A,QItemLabel:ye.A,QColor:Ft.A});var It={name:"ControlsPanel",components:{SelectedModel:rt,ObjectDetails:wt},computed:{...(0,b.aH)("app",["controlTab"]),tab:{get(){return this.controlTab},set(e){this.setControlTab(e)}}},methods:{...(0,b.PY)("app",["setControlTab"])}};const _t=(0,ue.A)(It,[["render",Ne]]);var Mt=_t;function qt(e,t,l,a,s,c){const n=(0,o.g2)("q-spinner"),i=(0,o.g2)("q-card-section"),d=(0,o.g2)("q-card"),u=(0,o.g2)("q-dialog");return(0,o.uX)(),(0,o.Wv)(u,{modelValue:c.dialog,"onUpdate:modelValue":t[0]||(t[0]=e=>c.dialog=e),persistent:""},{default:(0,o.k6)((()=>[(0,o.bF)(d,null,{default:(0,o.k6)((()=>[(0,o.bF)(i,null,{default:(0,o.k6)((()=>[(0,o.bF)(n,{color:"primary",size:"2em",class:"q-mr-md"}),(0,o.eW)(" "+(0,r.v_)(e.$t("text.loadingAppState")),1)])),_:1})])),_:1})])),_:1},8,["modelValue"])}ke()(It,"components",{QTabs:Oe.A,QTab:Te.A,QTabPanels:Qe.A,QTabPanel:Xe.A});var Pt={name:"InitModal",computed:{...(0,b.aH)("product",["models"]),dialog:{get(){return 0===this.models.length},set(){}}}},jt=l(5704);const Ot=(0,ue.A)(Pt,[["render",qt]]);var Tt=Ot;ke()(Pt,"components",{QDialog:jt.A,QCard:tt.A,QCardSection:lt.A,QSpinner:Fe.A});var Qt={name:"LayoutDefault",inject:["ctx"],components:{LayersPanel:Ve,ControlsPanel:Mt,ModeSelector:De,InitModal:Tt},mounted(){const e=new URL(window.location.href),t=e.searchParams.get("product_id"),l=e.searchParams.get("project_id");this.loadProductModels(t,l);const a=this.$refs.canvas;this.ctx.canvas=new g.fabric.Canvas(a,{selection:!1,allowTouchScrolling:!0}),this.ctx.canvas.on("before:selection:cleared",(()=>{this.resetSelectedLayer(),this.setControlTab("product")})),this.ctx.canvas.on("selection:created",(e=>{this.handleSelection(e)})),this.ctx.canvas.on("selection:updated",(e=>{this.handleSelection(e)})),this.ctx.canvas.on("object:modified",(e=>{"scale"!==e.action&&"rotate"!==e.action||(this.selectedLayer.dirty=!0)})),this.ctx.canvas.on({"object:added":()=>this.syncLayers(this.ctx.canvas.getObjects()),"object:removed":()=>this.syncLayers(this.ctx.canvas.getObjects())}),this.ctx.canvas.on("mouse:dblclick",(({target:e})=>{e&&"image"===e.type&&K.prepareCrop(e)})),document.addEventListener("keydown",(e=>{if(["Delete","Backspace"].includes(e.key)&&this.selectedLayer.layerId){if(document.querySelector(".layer-text-field")?.matches(":focus"))return;K.removeLayer(this.selectedLayer)}})),ee().load(ae)},computed:{...(0,b.aH)("app",["user"]),...(0,b.aH)("canvas",["selectedLayer"]),...(0,b.aH)("product",["selectedModelColor"]),...(0,b.L8)("product",["selectedModelColorUrl"]),...(0,b.L8)("product",["selectedModelCoordinated"])},watch:{user(e){this.loadProductModels(e?.id)},selectedModelColorUrl(e){this.ctx.canvas.setHeight(this.selectedModelCoordinated.height),this.ctx.canvas.setWidth(this.selectedModelCoordinated.width),this.ctx.canvas.renderAll()}},methods:{...(0,b.PY)("app",["setUser","setControlTab"]),...(0,b.PY)("order",["setPricing"]),...(0,b.PY)("canvas",["syncLayers","setSelectedLayer","resetSelectedLayer"]),...(0,b.PY)("product",["setModels"]),handleSelection(e){let t=e.selected[0];this.selectedLayer.layerId!=t.layerId&&(this.setSelectedLayer(t),this.setControlTab("object"))},async loadPricing(){let e=await j.getPrices();e&&this.setPricing(e)},async loadProductModels(e,t){let l=await G.getModel(e,t);this.setModels(l)},async logout(){await q.logout(),window.location.reload()},setLanguage(e){this.$i18n.locale=e,L(e)}}},Xt=l(7347),Wt=l(6284),Vt=l(1399);const Ut=(0,ue.A)(Qt,[["render",m]]);var zt=Ut;ke()(Qt,"components",{QLayout:Xt.A,QPageContainer:Wt.A,QPage:Vt.A});var $t=l(5139);_.A.registerType("error",{color:"negative",icon:"error"}),_.A.registerType("success",{color:"positive",icon:"check_circle"}),_.A.registerType("orderSuccess",{color:"positive",position:"center"});var Et={plugins:{Notify:_.A},config:{notify:{position:"top-right",timeout:2500,progress:!0}}};(0,a.Ef)(zt).use($t.A,Et).use(H).use(A).provide("ctx",N).mount("#app")},6574:function(){},2748:function(){},2246:function(){}},t={};function l(a){var o=t[a];if(void 0!==o)return o.exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,l),r.exports}l.m=e,function(){var e=[];l.O=function(t,a,o,r){if(!a){var s=1/0;for(d=0;d<e.length;d++){a=e[d][0],o=e[d][1],r=e[d][2];for(var c=!0,n=0;n<a.length;n++)(!1&r||s>=r)&&Object.keys(l.O).every((function(e){return l.O[e](a[n])}))?a.splice(n--,1):(c=!1,r<s&&(s=r));if(c){e.splice(d--,1);var i=o();void 0!==i&&(t=i)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[a,o,r]}}(),function(){l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,{a:t}),t}}(),function(){l.d=function(e,t){for(var a in t)l.o(t,a)&&!l.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){l.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};l.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,r,s=a[0],c=a[1],n=a[2],i=0;if(s.some((function(t){return 0!==e[t]}))){for(o in c)l.o(c,o)&&(l.m[o]=c[o]);if(n)var d=n(l)}for(t&&t(a);i<s.length;i++)r=s[i],l.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return l.O(d)},a=self["webpackChunkrtp_print_designer"]=self["webpackChunkrtp_print_designer"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=l.O(void 0,[504],(function(){return l(859)}));a=l.O(a)})();
//# sourceMappingURL=app.4ab9c9f9.js.map